<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <link rel="icon" crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/favicon.ico" />
    <!-- Preload is necessary because we show these images when we disconnect from the server,
    but at that point we cannot load these images from the server -->
    <link rel="preload" crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/gradient-yHQUC_QB.png" as="image" />
    <link rel="preload" crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/noise-60BoTA8O.png" as="image" />
    <!-- Preload the fonts -->
    <link rel="preload" crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/Lora-VariableFont_wght-B2ootaw-.ttf" as="font" crossorigin="anonymous" />
    <link rel="preload" crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/PTSans-Regular-CxL0S8W7.ttf" as="font" crossorigin="anonymous" />
    <link rel="preload" crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/PTSans-Bold-D9fedIX3.ttf" as="font" crossorigin="anonymous" />
    <link rel="preload" crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/FiraMono-Regular-BTCkDNvf.ttf" as="font" crossorigin="anonymous" />
    <link rel="preload" crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/FiraMono-Medium-DU3aDxX5.ttf" as="font" crossorigin="anonymous" />
    <link rel="preload" crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/FiraMono-Bold-CLVRCuM9.ttf" as="font" crossorigin="anonymous" />

    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="theme-color" content="#000000" />
    <meta name="description" content="a marimo app" />
    <link rel="apple-touch-icon" crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/apple-touch-icon.png" />
    <link rel="manifest" crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/manifest.json" />

    <script data-marimo="true">
      function __resizeIframe(obj) {
        const scrollbarHeight = 20; // Max between windows, mac, and linux

        function setHeight() {
          // Guard against race condition where iframe isn't ready
          if (!obj.contentWindow?.document?.documentElement) {
            return;
          }
          const element = obj.contentWindow.document.documentElement;
          // If there is no vertical scrollbar, we don't need to resize the iframe
          if (element.scrollHeight === element.clientHeight) {
            return;
          }

          // Create a new height that includes the scrollbar height if it's visible
          const hasHorizontalScrollbar = element.scrollWidth > element.clientWidth;
          const newHeight = element.scrollHeight + (hasHorizontalScrollbar ? scrollbarHeight : 0);

          // Only update the height if it's different from the current height
          if (obj.style.height !== `${newHeight}px`) {
            obj.style.height = `${newHeight}px`;
          }
        }

        // Resize the iframe to the height of the content and bottom scrollbar height
        setHeight();

        // Resize the iframe when the content changes
        const resizeObserver = new ResizeObserver((_entries) => {
          setHeight();
        });
        // Only observe if iframe content is ready
        if (obj.contentWindow?.document?.body) {
          resizeObserver.observe(obj.contentWindow.document.body);
        }
      }
    </script>
    <marimo-filename hidden>RankOneConvexification.py</marimo-filename>
    <!-- TODO(Trevor): Legacy, required by VS Code plugin. Remove when plugin is updated (see marimo/server/_templates/template.py) -->
    <marimo-version data-version="{{ version }}" hidden></marimo-version>
    <marimo-user-config data-config="{{ user_config }}" hidden></marimo-user-config>
    <marimo-server-token data-token="{{ server_token }}" hidden></marimo-server-token>
    <!-- /TODO -->
    <title>RankOneConvexification</title>
    <script type="module" crossorigin crossorigin="anonymous" src="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/index-3OIHLLq_.js"></script>
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/preload-helper-g1IWzEZ-.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/chunk-LvLJmgfZ.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/react-XTZdWHwa.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/compiler-runtime-QczY1yfQ.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/useEventListener-4mpeqPxW.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/react-dom-BZDtXk6t.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/jsx-runtime-DUsrKwmN.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/Combination-D2HqSOvH.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/clsx-FpJB9huX.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/cn-Cs2e4A8T.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/menu-items-B57SjdWM.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/hotkeys-Dh4gy4JD.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/button-D8mnDDLX.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/dist-Dj-O1Spr.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/createLucideIcon-BJ2I6csQ.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/check-CWbw3kKW.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/select-CgZgQ5hV.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/multi-map-D3NvLiI9.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/chevron-right-B_qBg_RU.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/dropdown-menu-Ciqx4yT-.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/tooltip-DqNvr2Rw.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/_Uint8Array-BGESiCQL.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/_getTag-BWqNuuwU.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/_baseIsEqual-C8v2yRqO.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/jotai-D74Ef_p1.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/invariant-Amh6wt4N.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/isArrayLikeObject-BkJc8lDE.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/merge-5YNOh9ZD.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/zod-BBqism5D.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/utils-x9KlwLm7.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/requests-THIDPq-F.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/once-BxRirs3K.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/toDate-Y5T6FHPx.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/isSymbol-BGkTcW3U.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/toString-DlRqgfqz.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/_baseSlice-BoaxdS7L.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/_hasUnicode-CNlKPr15.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/useLifecycle-8fgb5Nue.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/capitalize-L9-XHPtm.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/ai-model-dropdown-CO52rzQt.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/badge-Cm0WUI-_.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/use-toast-DKTyV2AR.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/constants-BmIIVBf_.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/Deferred-9HYzcD3r.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/config-CbG7e0K6.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/uuid-B8w6pjWV.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/DeferredRequestRegistry-DfLQSvoS.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/connection-B11rCPnY.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/useNonce-D8CLFIrY.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/capabilities-Bdlrhekp.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/createReducer-VgoBNe3M.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/dist-C3a_7WFa.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/dist-0z0sEYV-.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/dist-BzfTz_Dx.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/dist-DmruaXMM.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/dist-DU0YrNRK.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/dist-_bGPtAsk.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/dist-DsSBESho.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/dist-B2TjmP7E.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/dist-BzDb7E9f.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/stex-C4ZxI0N3.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/cjs-Ba5CQnxe.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/_arrayReduce-DdxhySYh.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/type-kFt-n-jZ.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/_baseProperty-D0ckTA0L.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/toNumber-GB_lFVaq.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/now-CAWn5i9V.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/debounce-Bgq-wc7M.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/toInteger-Cl1doThW.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/main-CC_mbgxK.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/cells-DoKM12vd.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/kbd-EdFdwHEs.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/renderShortcut-CLenKJO6.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/useEvent-l9BzRqpK.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/useDeleteCell-BDBSmjLV.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/lazy-Cbg8zRvU.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/defaultLocale-8c1ixjJ_.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/precisionRound-CQhbsDNz.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/defaultLocale-BECdiY5x.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/vega-loader.browser-DZ31-605.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/tooltip-CSAGVmjx.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/ErrorBoundary-6EjkHrSV.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/alert-dialog-D9SwG8oA.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/dialog-BPIq0Dmw.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/useDebounce-C9S6xmGh.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/numbers-BigybruE.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/SSRProvider-DlZbKHsu.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/context-CO64Gasq.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/useNumberFormatter-B5HAJDUq.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/usePress-DHxqjtDm.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/input-CVoLDDk-.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/ImperativeModal-ameyIrhc.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/cell-link-BiAu_8pk.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/alert-D5BMn3Et.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/links-Iv0WhyKW.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/state-i7G4J1VS.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/MarimoErrorOutput-Bh7Bgl2Z.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/copy-BS3uwoaq.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/copy-DhmkXAPp.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/copy-icon-Lyk2_Z8G.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/spinner-DpaQpaiI.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/dist-D1pae9A2.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/focus-CyxSol0W.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/popover-DZBXSGEz.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/useRunCells-DT1En-Te.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/mode-DKDAYLK9.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/purify.es-hXMlfS4W.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/RenderHTML-Dlz0Ew2i.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/table-CesNYRF-.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/tabs-BjAbB8w_.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/add-missing-import-DV1FOw9w.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/useAsyncData-_-DLduEH.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/useIframeCapabilities-r0LQMxAQ.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/LazyAnyLanguageCodeMirror-C7KtNlRp.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/error-banner-C9tkg1MX.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/formats-C3exma5i.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/useTheme-DpA-8Qyy.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/en-US-Lc4gASCJ.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/isValid-Cd_L_2Pm.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/maps-D4abje2p.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/shim-D-ElLTBO.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/download-CCvBQ7qL.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/extends-C2lJEiP_.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/emotion-is-prop-valid.esm-c4A1huxA.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/useDateFormatter-BMdQ9MI_.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/katex-BmfUoCWW.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/marked.esm-idL59iHw.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/chunk-T7OEMACY-CdGEwedE.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/range-Bbli-TEL.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/table-kHJ0xpFt.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/Output-DxdWGPFi.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/name-cell-input-C6ZYU6mN.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/useHotkey-B0ylhc2m.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/dist-CqHWOZu2.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/dist-BcLYYUSi.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/dist-BVXr6b5T.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/dist-BrEX5EQl.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/dist-CalRK9ms.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/dist-Cc4T7UUX.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/dist-D3MC5WiF.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/dist-DgaCIZAa.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/dist-rqHtY98i.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/dist-tj-jaP-y.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/dist-w7c0BKrD.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/dist-CCZcRJI9.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/dist-CrDb6akR.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/apl-BQt6lLuE.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/asciiarmor-BjX7bs0j.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/asn1-xn1MtyoW.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/brainfuck-BjO-UY1i.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/clike-DW9tQWfF.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/clojure-BSW96HRx.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/cmake-C7UlMfz3.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/cobol-CyWIev3Y.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/coffeescript-DTvziYTK.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/commonlisp-yMdkdGMi.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/crystal-BGnoSp3z.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/css-D7fWzevp.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/cypher-Cr1dl0Qf.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/d-C2bS5bA6.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/diff-B2mHQyn6.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/dtd-Cy-lUE7p.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/dylan-mm60grwk.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/ecl-Cqi05Wy1.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/eiffel-FkvfLQq7.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/elm-Da5txHw0.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/erlang-CdnCEH5x.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/simple-mode-B185hCuE.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/factor-CamlR8EJ.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/forth-UcMX0m31.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/fortran-DZ_vNVsP.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/gas-CM88o6Zj.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/gherkin-BhrpTeN9.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/groovy-BFju68Wx.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/haskell-CrWHY4et.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/haxe-1eKW-tbO.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/idl-Do4AwvU2.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/javascript-CTXZKRYd.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/julia-BRynwHI4.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/livescript-ZmIBNA-I.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/lua-mUfZ-MRC.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/mathematica-Dil5dTHO.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/mbox-Dnkn9wSr.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/mirc-auEWieOB.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/mllike-xVJsauJ8.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/modelica-B8kajVDm.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/mscgen-Bsnta1jn.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/mumps-CMw16b5q.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/nsis-DwPdi8sw.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/ntriples-O5lQxirn.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/octave-CMfAar-E.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/oz-CLRI9Qww.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/pascal-D2M_3HBx.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/perl-B8lV7aKt.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/pig-Bima2bfE.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/powershell-v_t41ydu.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/properties-ChrStSby.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/protobuf-Bin6kmlf.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/pug-UWVdYLYW.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/puppet-DYrtWvYn.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/python-BuKrulde.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/q-CrXUTiVN.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/r-Bk2Tiso2.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/rpm-CmmZphz3.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/ruby-ElyOTVeQ.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/sas-jE3ZlG0K.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/scheme-CZF1tRbv.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/shell-LqT3ZqMa.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/sieve-y15yT7Pp.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/smalltalk-pk5PvsMs.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/sparql-DTZ_gfPQ.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/stylus-CrGj0eNT.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/swift-tt3PlBbI.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/tcl-1P4b0GMJ.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/textile-BHDIuMYh.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/toml-C8qoqk_i.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/troff-DMiF5Zmz.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/ttcn-cfg-qLZtNU-E.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/ttcn-BAUp3RZn.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/turtle-BizIwmKv.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/vb-Bn_uCxNL.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/vbscript-BTKW8Atx.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/velocity-CcB05fpi.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/verilog-BWdtOJH8.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/vhdl-CzFOaOHx.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/webidl-DDEKCqSy.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/xquery-BcF6ZhQP.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/yacas-BARQAiXa.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/z80-DO_Ep0iT.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/esm-DnNh7vdQ.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/objectWithoutPropertiesLoose-DDabolgJ.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/esm-Crqxhl3F.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/trash-Df8Wb7xS.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/ConsoleOutput-D8ETq-cc.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/icons-BgmgMjOV.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/blob-LiDbeYko.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/add-cell-with-ai-85tnyxYo.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/chart-no-axes-column-BrQ3B3xc.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/square-function-D5EEjILG.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/spec-DpllSlJD.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/useInstallPackage-BaAhpZlP.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/column-preview-DGBk0umL.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/useAddCell-DYfGo4T8.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/toggle-PGHtwx2G.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/api-CoLss8_O.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/globals-oV9pRUSB.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/share-DjbnD3WE.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/memoize-DN0TMY36.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/get-CyLJYAfP.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/_baseSet-CKSmZC_I.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/utilities.esm-DvrcU9Ky.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/floating-outline-DmCT2Mvg.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/eye-off-BUwXWtH0.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/plus-CiGrWbgb.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/readonly-python-code-CkaJ4Tks.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/file-video-camera-BGBfFNDn.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/file-text-O5IflCIn.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/file-CqXxt3_J.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/types-BMriRmf-.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/label-4Nancvon.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/textarea-BnZHy5Jt.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/circle-x-Cc9X6U_B.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/refresh-ccw-aU2rUkrI.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/trash-2-Du5ITnDv.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/form-600t_Civ.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/field-Dov6YyOV.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/switch-Ct8mUApv.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/useBoolean-Dmwks1uh.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/useDeepCompareMemoize-C8RdAYFq.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/types-D0WVpW93.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/prop-types-WJwGTMoZ.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/es-DAmFxw3U.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/VisuallyHidden-RqykLBKh.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/_baseFlatten-rM2FaX4x.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/hasIn-CE-pxQP-.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/_basePickBy-LbasZ8ix.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/pick-FbHfDtcJ.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/send-LAFRRDPT.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/code-xml-DdSOsi73.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/download-Dmmu2U4a.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/globe-vMZtva7z.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/refresh-cw-BOc7UXm9.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/settings-DznrHqbd.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/square-DhlBDqyx.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/triangle-alert-Bf1kg4xT.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/dist-DL3W3q-2.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/bundle.esm-C-9IAWQU.js">
    <link rel="stylesheet" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/cells-wU8qigWB.css">
    <link rel="stylesheet" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/Output-DUep6sC9.css">
    <link rel="stylesheet" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/ConsoleOutput-BFFTcC5Y.css">
    <link rel="stylesheet" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.18.4/dist/assets/index-CJU5NUvF.css">
  
<script data-marimo="true">
    window.__MARIMO_STATIC__ = {};
    window.__MARIMO_STATIC__.files = {};
</script>
</head>
  <body>
    <div id="root"></div>
    <!-- This is a portal for the data editor to render in -->
    <div id="portal" data-testid="glide-portal" style="position: fixed; left: 0; top: 0; z-index: 9999"></div>
    <script data-marimo="true">
      window.__MARIMO_MOUNT_CONFIG__ = {
            "filename": "RankOneConvexification.py",
            "mode": "read",
            "version": "0.18.4",
            "serverToken": "static",
            "config": {"ai": {"models": {"custom_models": [], "displayed_models": []}}, "completion": {"activate_on_typing": true, "copilot": false}, "diagnostics": {"sql_linter": true}, "display": {"cell_output": "below", "code_editor_font_size": 14, "dataframes": "rich", "default_table_max_columns": 50, "default_table_page_size": 10, "default_width": "medium", "reference_highlighting": false, "theme": "light"}, "formatting": {"line_length": 79}, "keymap": {"overrides": {}, "preset": "default"}, "language_servers": {"pylsp": {"enable_flake8": false, "enable_mypy": true, "enable_pydocstyle": false, "enable_pyflakes": false, "enable_pylint": false, "enable_ruff": true, "enabled": false}}, "mcp": {"mcpServers": {}, "presets": []}, "package_management": {"manager": "pip"}, "runtime": {"auto_instantiate": false, "auto_reload": "off", "default_sql_output": "auto", "on_cell_change": "autorun", "output_max_bytes": 8000000, "reactive_tests": true, "std_stream_max_bytes": 1000000, "watcher_on_save": "lazy"}, "save": {"autosave": "after_delay", "autosave_delay": 1000, "format_on_save": false}, "server": {"browser": "default", "follow_symlink": false}, "snippets": {"custom_paths": [], "include_default_snippets": true}},
            "configOverrides": {},
            "appConfig": {"sql_output": "auto", "width": "medium"},
            "view": {"showAppCode": true},
            "notebook": {"cells": [{"code": "import marimo as mo\nimport numpy as np\nfrom mosek.fusion import Model, Domain, Expr, ObjectiveSense, Matrix, Var\nimport mosek.fusion.pythonic\nimport sys\nimport requests, zipfile, io, os, glob\nfrom sklearn.preprocessing import StandardScaler\nimport pandas as pd\nimport time", "code_hash": "4f62e23c465ed8f78d30dd30c7877ab5", "config": {"column": null, "disabled": false, "hide_code": true}, "id": "Hbol", "name": "_"}, {"code": "mo.md(\n    r\"\"\"\n# Rank-One Sparse Regression Model\n\nThis notebook is based on [Rank-one Convexification for Sparse Regression](https://arxiv.org/abs/1901.10334) by Atamt\u00fcrk and G\u00f3mez. \n\nIn the paper a model is designed to solve regression problems when the number of predictors is large and we expect only a small subset of them to be truly relevant. This model combines **quadratic loss minimization** with a **sparsity-inducing penalty** and a **conic reformulation** that makes the optimization problem tractable. Some properties this model offers to users:\n\n- **Feature selection**: It automatically selects only the most relevant predictors.  \n- **Interpretability**: Produces simpler, more interpretable models.  \n- **Regularization**: Prevents overfitting by discouraging unnecessarily large coefficients.  \n- **High-dimensional settings**: Particularly useful when the number of predictors \\(p\\) is large compared to the number of samples \\(n\\).  \n\nIn short, this model balances **accuracy** and **sparsity**, giving us predictive models that are both powerful and easy to interpret.\n\"\"\"\n)", "code_hash": "1be5453888a9922fc8d8d4a1548eb294", "config": {"column": null, "disabled": false, "hide_code": true}, "id": "MJUe", "name": "_"}, {"code": "mo.md(\n    r\"\"\"\nWe consider the following optimization problem:\n\n\\[\n\\min_{\\beta \\in \\mathbb{R}^p} \\;\\; \n\\|y - X\\beta\\|_2^2 \n\\;+\\; \\lambda \\|\\beta\\|_2^2 \n\\;+\\; \\mu \\|\\beta\\|_1 \n\\]\n\n\\[\n\\quad \\text{s.t.} \\quad \\|\\beta\\|_0 \\leq k\n\\]\n\nwhere: \n\n- \\(y \\in \\mathbb{R}^n\\) : response vector (observed outcomes).  \n- \\(X \\in \\mathbb{R}^{n \\times p}\\) : design (feature) matrix with \\(n\\) samples and \\(p\\) predictors.   \n- \\(\\lambda \\geq 0\\) : regularization parameter controlling the ridge penalty.  \n- \\(\\mu \\geq 0\\) : regularization parameter controlling the lasso penalty.  \n- \\(k\\) : sparsity level, i.e., maximum number of predictors allowed to be nonzero.\n\"\"\"\n)", "code_hash": "4fb5b85a49e4dd035b92b84ec067c1a0", "config": {"column": null, "disabled": false, "hide_code": true}, "id": "vblA", "name": "_"}, {"code": "mo.md(\n    r\"\"\"\nThis optimization problem extends least squares regression by adding two regularization terms and a sparsity constraint:\n\n- Squared error term $\\|y - X\\beta\\|_2^2$: Penalizes discrepancies between predictions $X\\beta$ and the observed responses $y$.\n\n- Ridge penalty $\\lambda \\|\\beta\\|_2^2$: Shrinks coefficient values to improve numerical stability and reduce overfitting (especially when predictors are correlated or $p$ is large).\n\n- Lasso penalty $\\mu \\|\\beta\\|_1$: Encourages sparsity by shrinking some coefficients to zero.\n\n- Cardinality constraint $\\|\\beta\\|_0 \\leq k$: Limits the number of nonzero entries in $\\beta$ to at most $k$, directly enforcing sparsity and interpretability.\n\n\nIn the model the cardinality constraint is usually problematic in application. This is a hard sparsity constraint and problems involving this count constraint are usually *NP-Hard*. Therefore instead of solving this model, the following transformation is applied. \n\nIn the model the cardinality constraint is usually problematic in practice. This is a hard sparsity constraint, which forces the solution to include at most \ud835\udc58 nonzero coefficients. However, optimization problems with such a count constraint are generally NP-hard, since solving them requires searching through all possible subsets of predictors. Therefore, instead of solving this formulation directly, the model is often transformed or relaxed into an alternative form that can be solved efficiently.\n\"\"\"\n)", "code_hash": "6f48c984a837b9445d6fde206069befc", "config": {"column": null, "disabled": false, "hide_code": true}, "id": "bkHC", "name": "_"}, {"code": "mo.md(r\"\"\"## Alternative Reformulation\"\"\")", "code_hash": "8e9259fd3a331c7e6d08290c70463d19", "config": {"column": null, "disabled": false, "hide_code": true}, "id": "lEQa", "name": "_"}, {"code": "mo.md(\n    r\"\"\"\n$$\n\\min_{\\beta \\in \\mathbb{R}^p}\\;\n\\|y - X\\beta\\|_2^2 \\;+\\; \\lambda \\|\\beta\\|_2^2 \\;+\\; \\mu \\|\\beta\\|_1\n\\quad \\text{s.t.}\\quad \\|\\beta\\|_0 \\le k .\n$$\n\"\"\"\n)", "code_hash": "36f78a4bea7665702725d3c4398796b2", "config": {"column": null, "disabled": false, "hide_code": true}, "id": "PKri", "name": "_"}, {"code": "mo.md(\n    r\"\"\"\nAs the first step, expand the first two terms in the objective function. Through expansion one can see that we easily reach the general quadratic form. \n\n$$\n\\|y - X\\beta\\|_2^2\n= y^\\top y - 2\\,y^\\top X\\beta + \\beta^\\top X^\\top X \\beta .\n$$\n\nThen the partial objective becomes: \n\n$$\n\\|y - X\\beta\\|_2^2 + \\lambda\\|\\beta\\|_2^2\n= y^\\top y - 2\\,y^\\top X\\beta + \\beta^\\top (X^\\top X + \\lambda I)\\beta .\n$$\n\"\"\"\n)", "code_hash": "1be817b01357a64551af47ec29aabbbd", "config": {"column": null, "disabled": false, "hide_code": true}, "id": "Xref", "name": "_"}, {"code": "mo.md(\n    r\"\"\"\nThe $\\ell_1$-norm $\\|\\beta\\|_1 = \\sum_{i=1}^p |\\beta_i|$ is replaced by auxiliary variables $u_i \\ge 0$ with constraints: \n\n\\[\n-u_i \\le \\beta_i \\le u_i .\n\\]\n\nThese linear inequalities ensure $u_i \\ge |\\beta_i|$. Since the objective \nminimizes $\\sum_{i=1}^p u_i$, at optimality we have $u_i = |\\beta_i|$. \nThus, \n\n\\[\n\\|\\beta\\|_1 = \\sum_{i=1}^p u_i\n\\]\n\nis exactly represented in linear form.\n\"\"\"\n)", "code_hash": "2b313422d172380a2ed888166cfa4076", "config": {"column": null, "disabled": false, "hide_code": true}, "id": "SFPL", "name": "_"}, {"code": "mo.md(\n    r\"\"\"\nTo model the cardinality constraint $\\|\\beta\\|_0 \\le k$, we introduce binary \nindicator variables $z_i \\in \\{0,1\\}$ for each coefficient. Formally, \n$z_i = 1$ if $\\beta_i$ is allowed to be nonzero, and $z_i = 0$ if \n$\\beta_i$ must be zero. Thus, every nonzero $\\beta_i$ is *counted* \nthrough its corresponding indicator $z_i$.\n\nThe constraint below ensures that at most $k$ coefficients can be nonzero. \n\n\\[\n\\sum_{i=1}^p z_i \\le k\n\\]\n\n\nTo enforce the connection between $\\beta_i$ and its indicator $z_i$, one can impose: \n\n\\[\\beta_i (1 - z_i) = 0 \\quad \\text{for } i=1,\\dots,p\\]\n\nThis guarantees the *either\u2013or* relationship: if $z_i=0$, then $\\beta_i = 0$, while if $z_i=1$, then $\\beta_i$ is free to take a \nnonzero value. In this way, the challenge of the count operation can be worked around.\n\"\"\"\n)", "code_hash": "a750fa1dbfe92287d2ec34492b0ef547", "config": {"column": null, "disabled": false, "hide_code": true}, "id": "BYtC", "name": "_"}, {"code": "mo.md(r\"\"\" \"\"\")", "code_hash": "89207e7e83c64f69805fac4f5069f9c4", "config": {"column": null, "disabled": false, "hide_code": true}, "id": "RGSE", "name": "_"}, {"code": "mo.md(\n    r\"\"\"\nAt this point, to model the constraint  \n\n$$\n\\beta_i (1 - z_i) = 0, \\quad i=1,\\dots,p,\n$$  \n\nthe paper suggests introducing a *big-$M$* formulation. In that approach, large constants are used to relax the constraint and enforce the link between $\\beta_i$ and $z_i$.  \n\nAfter the big-$M$ value is fixed, the calculation becomes relatively easy to implement. However, **determining a suitable big-$M$ value is itself a challenge**. If $M$ is chosen too small, the model may cut off feasible solutions. If $M$ is chosen too large, the relaxation becomes weak and the solver may perform poorly. Therefore, based on the specific problem and the data at hand, an **appropriate big-$M$ value must be determined each time**.  \n\nThere is no universal choice:  \n- The bound should be large enough so that all feasible $\\beta_i$ can be represented.  \n- But it should not be excessively large, since that would weaken the relaxation and slow down the solver.  \n\n\nBy contrast, **MOSEK** has native support for *disjunctive constraints*. This means we do not need to approximate with big-$M$. Instead, we can directly model the logical condition:  \n\n- Either $z_i = 1$ (the variable $\\beta_i$ is allowed to be nonzero),  \n- Or $\\beta_i = 0$ (the variable is forced to zero when $z_i = 0$).  \n\nThis way, the constraint is expressed exactly as an **either\u2013or** condition, and MOSEK will internally handle the disjunction:\n\n\\[\n\\beta_i = 0 \\;\\;\\;\\; \\lor \\;\\;\\;\\; z_i = 1, \n\\quad i = 1,\\dots,p .\n\\]\n\"\"\"\n)", "code_hash": "408e2ca1c64af4961a6926390243e46c", "config": {"column": null, "disabled": false, "hide_code": true}, "id": "Kclp", "name": "_"}, {"code": "mo.md(\n    r\"\"\"\nThen the final model becomes:\n\n$$\n\\begin{aligned}\n\\min_{\\beta,u,z}\\quad\n\u0026 -\\,2\\,y^\\top X\\beta \\;+\\; \\beta^\\top (X^\\top X + \\lambda I)\\beta \\;+\\; \\mu \\sum_{i=1}^p u_i \\\\\n\\text{s.t.}\\quad\n\u0026 -u_i \\le \\beta_i \\le u_i,\\;\\; u_i \\ge 0, \\quad i=1,\\dots,p, \\\\\n\u0026 \\beta_i = 0 \\;\\;\\;\\; \\lor \\;\\;\\;\\; z_i = 1, \n\\quad i = 1,\\dots,p \\\\\n\u0026 \\sum_{i=1}^p z_i \\le k, \\quad z_i \\in \\{0,1\\}, \\;\\; i=1,\\dots,p, \\\\\n\u0026 \\beta \\in \\mathbb{R}^p,\\;\\; z \\in \\{0,1\\}^p,\\;\\; u \\in \\mathbb{R}_+^p.\n\\end{aligned}\n$$\n\"\"\"\n)", "code_hash": "613e412037c387cc740c7ec6a52302f7", "config": {"column": null, "disabled": false, "hide_code": true}, "id": "emfo", "name": "_"}, {"code": "mo.md(r\"\"\"## Model Implementation\"\"\")", "code_hash": "0a6c567ed460ade77533c6c93cd10a06", "config": {"column": null, "disabled": false, "hide_code": true}, "id": "Hstk", "name": "_"}, {"code": "mo.md(\n    r\"\"\"\nThe objective we are minimizing has three types of terms:\n\n\\[\n-2y^\\top X \\beta \\;+\\; \\beta^\\top (X^\\top X + \\lambda I)\\beta \\;+\\; \\mu \\sum_i u_i \\;+\\; \\text{const.}\n\\]\n\n---\n\n## 1. Linear terms:\n\n- The scalar term \\(-2y^\\top X\\beta\\) is a simple inner product, i.e. linear in the decision variables \\(\\beta\\).\n- The penalty \\(\\mu \\sum_i u_i\\) is also linear in the auxiliary variables \\(u_i\\).  \nThese can be added directly to the optimization model without special reformulation.\n\n---\n\n## 2. Quadratic Term\n\nThe expression\n\n\\[\n\\beta^\\top (X^\\top X + \\lambda I)\\beta\n\\]\n\nis **quadratic**. \nThere are **two approaches** we can apply to handle it as a rotated second-order cone (RSOC) constraint.\n\n\n---\n\n### Option 1: Cholesky-based approach\n\nTo encode it in a conic optimization model, we introduce an auxiliary variable \\(t\\) representing the quadratic form:\n\n\\[\nt \\;\\ge\\; \\beta^\\top Q \\beta, \\quad Q = X^\\top X + \\lambda I\n\\]\n\n\n\n1. Since \\(Q\\) is positive semidefinite we can perform a **Cholesky decomposition**:\n\n\\[\nQ = L L^\\top\n\\]\n\n2. Express the quadratic form as a norm:  \n\n\\[\n\\beta^\\top Q \\beta = \\| L^\\top \\beta \\|_2^2\n\\]\n\n3. Encode it as a **rotated SOC constraint**:\n\n\\[\n(1,\\; 0.5\\,t,\\; L^\\top \\beta) \\;\\in\\; \\mathcal{Q}_r\n\\]\n\nThis enforces \\(t \\ge \\| L^\\top \\beta \\|_2^2\\).\n\n---\n\n### Option 2: Stacked-matrix approach (no Cholesky)\n\nFirstly, let's introduce an auxiliary variable \\(t\\) representing the quadratic form again:\n\n\\[\nt \\;\\ge\\; \\beta^\\top (X^\\top X + \\lambda I)\\beta\n\\]\n\n1. Stack \\(X\\) and \\(\\sqrt{\\lambda} I\\) vertically:\n\n\\[\n\\begin{bmatrix} X \\\\ \\sqrt{\\lambda} I \\end{bmatrix}\n\\]\n\n2. Express the quadratic form as a norm:\n\n\\[\n\\beta^\\top (X^\\top X + \\lambda I) \\beta = \\left\\| \\begin{bmatrix} X \\\\ \\sqrt{\\lambda} I \\end{bmatrix} \\beta \\right\\|_2^2\n\\]\n\n3. Introduce a scalar variable \\(t \\ge \\| [X; \\sqrt{\\lambda} I] \\beta \\|_2\\) and write as a **rotated SOC constraint**:\n\n\\[\n\\left(1, \\frac{t}{2}, \\begin{bmatrix} X \\\\ \\sqrt{\\lambda} I \\end{bmatrix} \\beta \\right) \\;\\in\\; \\mathcal{Q}_r\n\\]\n\nThis approach avoids Cholesky factorization and works well when \\(X\\) is sparse.\n\n---\n\n**Note on selection:**  \n\n- If \\(X\\) is **dense**, the Cholesky-based approach is usually faster and more efficient.  \n- If \\(X\\) is **sparse**, the stacked-matrix approach is preferred.  \n\nThe choice depends on the **structure of \\(X\\)** and the **solver/data requirements**.\n\n\n## 3. Putting it together:\n\n- The final objective is linear in \\(\\beta, u, t\\).\n- The only nonlinear part \\(\\beta^\\top Q \\beta\\) has been reformulated into a **cone constraint**, so the solver can handle it efficiently.\n\"\"\"\n)", "code_hash": "ff8e5621921428bb129c700889a354d7", "config": {"column": null, "disabled": false, "hide_code": true}, "id": "nWHF", "name": "_"}, {"code": "mo.md(r\"\"\"# Implementing the model in Python\"\"\")", "code_hash": "37a5288c583b3623139e849de153b4e2", "config": {"column": null, "disabled": false, "hide_code": true}, "id": "iLit", "name": "_"}, {"code": "mo.md(\n    r\"\"\"\nThe following function implements the model described earlier.  \n\nThe quadratic term can be handled using **either of the two approaches** depending on the user\u2019s preference and the input data:\n\n- If the user sets `cholesky = True` (the **default**), the function uses the **Cholesky-based transformation** (Option 1).  \n- If the user sets `cholesky = False`, the function uses the **stacked-matrix transformation** (Option 2).  \n\nThis design allows the model to adapt to the structure of the input data and the user\u2019s requirements while keeping the implementation flexible.\n\n\"\"\"\n)", "code_hash": "05b62f0e72274bed5a6e262c51876411", "config": {"column": null, "disabled": false, "hide_code": true}, "id": "ZHCJ", "name": "_"}, {"code": "def RankOne(n, p, lmb, mu, y , X, k,cholesky = True):\n    M = Model(\"RankOne\")\n\n    # Decision variables\n    B = M.variable(\"B\", p, Domain.unbounded())        # regression coefficients \u03b2\n    u = M.variable(\"u\", p, Domain.greaterThan(0.0))   # auxiliary vars for |\u03b2|\n    t = M.variable(\"t\", 1)                            # scalar var for quadratic form\n    z = M.variable(\"z\", p, Domain.binary())           # binary indicators for support\n\n    # Objective part: y\u1d40y (constant, included for completeness)\n    term1 = y.T @ y\n\n    # Objective part: -2 y\u1d40X\u03b2\n    term2 = -2 * Expr.mul(y.reshape(1, -1), Expr.mul(X, B))\n\n    if cholesky:\n        # Quadratic term \u03b2\u1d40(X\u1d40X + \u03bbI)\u03b2 handled with rotated quadratic cone\n        Q = (X.T @ X + lmb * np.identity(p))\n        w, V = np.linalg.eigh(Q)        # eigen-decomposition\n        L = V @ np.diag(np.sqrt(w))     # factor such that Q = L L\u1d40\n\n        # Cone constraint: (1, 0.5t, L\u1d40B) \u2208 Rotated Quadratic Cone\n        M.constraint(\n            Expr.vstack(1.0, 0.5 * t, Expr.mul(L.T, B)),\n            Domain.inRotatedQCone()\n        )\n    else:\n        # This corresponds to the stacked matrix [X; sqrt(lambda) * I_p] used for the quadratic form\n        Xp = np.vstack([X, np.sqrt(lmb) * np.identity(p)])\n\n        # Rotated Quadratic Cone constraint:\n        # (1, 0.5*t, [X; sqrt(lambda) I_p] * \u03b2) \u2208 Rotated Quadratic Cone\n        # This encodes the quadratic term \u03b2\u1d40(X\u1d40X + \u03bbI)\u03b2 as a rotated cone constraint\n        M.constraint(\n            Expr.vstack(1.0, 0.5 * t, Expr.mul(Xp, B)),\n            Domain.inRotatedQCone()\n        )\n\n\n    # L1 penalty term \u03bc\u2211 u_i\n    term4 = mu * Expr.sum(u)\n\n    # Cardinality constraint: at most k nonzeros\n    M.constraint(Expr.sum(z) \u003C= k)\n\n    # Relating u and B: |\u03b2_i| \u2264 u_i\n    M.constraint(B \u003C= u)\n    M.constraint(-B \u003C= u)\n\n    # Either-or condition: z_i = 1 OR \u03b2_i = 0\n    M.disjunction((z == 1) | (B == 0))\n\n    # Final objective: min (y\u1d40y - 2 y\u1d40X\u03b2 + \u03b2\u1d40Q\u03b2 + \u03bc\u2016\u03b2\u2016\u2081)\n    M.objective(ObjectiveSense.Minimize, term2 + t + term4 + term1)\n\n    # Export model and solve\n    M.writeTask(\"RankOne.ptf\")\n    s = time.time()\n    M.solve()\n    elapsed = time.time() - s\n    print(f\"Elapsed Time: {elapsed:.4f} s\")\n    print(f\"Objective value: {M.primalObjValue():.4f}\")\n    # Print solution status\n    ModelStatus = M.getPrimalSolutionStatus()\n    print(\"Model Status: \", ModelStatus)\n\n    return M", "code_hash": "4b7f73eedfa3b34265088840199c4fbc", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "ROlb", "name": "_"}, {"code": "mo.md(\n    r\"\"\"\nThe described model is implemented using Mosek above.\n\n```python\n    M.disjunction((z == 1) | (B == 0))\n```\n\nThe line above illustrates how **Mosek can implement disjunction constraints** without requiring any additional transformations, such as using Big-M values. \n\nTo run the model, we use the *diabetes dataset* shared by the referenced paper. We download, and load the dataset online in the code block below.\n\"\"\"\n)", "code_hash": "f38f804b18e456693bdd8982eab011f0", "config": {"column": null, "disabled": false, "hide_code": true}, "id": "qnkX", "name": "_"}, {"code": "mo.md(r\"\"\"## Loading the Data\"\"\")", "code_hash": "599a334623051a4a62235e5e6ed4d5b5", "config": {"column": null, "disabled": false, "hide_code": true}, "id": "TqIu", "name": "_"}, {"code": "# URL of the data\nurl = \"https://atamturk.ieor.berkeley.edu/data/sparse.regression/data.sparse.regression.zip\"\n\n# Download and unzip\nr = requests.get(url)\nz = zipfile.ZipFile(io.BytesIO(r.content))\nextract_dir = \"data_sparse_regression\"\nz.extractall(extract_dir)  # extracts to a local folder\n\n# Find a file that looks like the diabetes dataset (e.g., diabetes*.csv / .txt)\ncandidates = glob.glob(os.path.join(extract_dir, \"**\", \"diabetes*.*\"), recursive=True)\nif not candidates:\n    # If you know the exact name, set it here:\n    # file_path = os.path.join(extract_dir, \"data.sparse.regression\", \"diabetesQ.csv\")\n    raise FileNotFoundError(\"No file matching 'diabetes*' was found in the extracted contents.\")\n\nfile_path = candidates[0]\nprint(\"Using file:\", file_path)\n\n# Read the dataset (let pandas sniff the delimiter if not comma)\ndf = pd.read_csv(file_path, sep=None, engine=\"python\")\nprint(\"Columns in dataset:\", df.columns.tolist())\n\n# Assuming the last column is the target variable\nX_nonSTD = df.iloc[:, :-1].values\ny = df.iloc[:, -1].values\n\nX_nonSTD = X_nonSTD.astype(float)\n\n# Standardize features: zero mean, unit variance\nx_scaler = StandardScaler()\nX = x_scaler.fit_transform(X_nonSTD)\n\nprint(\"Shape of X (features):\", X.shape)\nprint(\"Shape of y (target):\", y.shape)", "code_hash": "cd1a338cdae1a1283112c5a5f94126ea", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "Vxnm", "name": "_"}, {"code": "mo.md(r\"\"\"Then using the loaded data, we can run the problem. As it can be seen from the printed out message below, the model is solved to feasibility.\"\"\")", "code_hash": "5690bd9bad250f88d1f70cd33bed21b7", "config": {"column": null, "disabled": false, "hide_code": true}, "id": "DnEU", "name": "_"}, {"code": "n,p = X.shape[0],X.shape[1]\nlmb = 5\nmu = 1\nk = p*0.8\n\nRankOne(n, p, lmb, mu, y , X, k,True)", "code_hash": "4d03f7a6098f4c07eef68ec63f2ea964", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "ulZA", "name": "_"}], "metadata": {"marimo_version": "0.18.4"}, "version": "1"},
            "session": {"cells": [{"code_hash": "4f62e23c465ed8f78d30dd30c7877ab5", "console": [], "id": "Hbol", "outputs": [{"data": {"text/plain": ""}, "type": "data"}]}, {"code_hash": "1be5453888a9922fc8d8d4a1548eb294", "console": [], "id": "MJUe", "outputs": [{"data": {"text/markdown": "\u003Cspan class=\"markdown prose dark:prose-invert contents\"\u003E\u003Ch1 id=\"rank-one-sparse-regression-model\"\u003ERank-One Sparse Regression Model\u003C/h1\u003E\n\u003Cspan class=\"paragraph\"\u003EThis notebook is based on \u003Ca href=\"https://arxiv.org/abs/1901.10334\" rel=\"noopener noreferrer\" target=\"_blank\"\u003ERank-one Convexification for Sparse Regression\u003C/a\u003E by Atamt\u00fcrk and G\u00f3mez.\u003C/span\u003E\n\u003Cspan class=\"paragraph\"\u003EIn the paper a model is designed to solve regression problems when the number of predictors is large and we expect only a small subset of them to be truly relevant. This model combines \u003Cstrong\u003Equadratic loss minimization\u003C/strong\u003E with a \u003Cstrong\u003Esparsity-inducing penalty\u003C/strong\u003E and a \u003Cstrong\u003Econic reformulation\u003C/strong\u003E that makes the optimization problem tractable. Some properties this model offers to users:\u003C/span\u003E\n\u003Cul\u003E\n\u003Cli\u003E\u003Cstrong\u003EFeature selection\u003C/strong\u003E: It automatically selects only the most relevant predictors.\u003C/li\u003E\n\u003Cli\u003E\u003Cstrong\u003EInterpretability\u003C/strong\u003E: Produces simpler, more interpretable models.\u003C/li\u003E\n\u003Cli\u003E\u003Cstrong\u003ERegularization\u003C/strong\u003E: Prevents overfitting by discouraging unnecessarily large coefficients.\u003C/li\u003E\n\u003Cli\u003E\u003Cstrong\u003EHigh-dimensional settings\u003C/strong\u003E: Particularly useful when the number of predictors \u003Cmarimo-tex class=\"arithmatex\"\u003E||(p||)\u003C/marimo-tex\u003E is large compared to the number of samples \u003Cmarimo-tex class=\"arithmatex\"\u003E||(n||)\u003C/marimo-tex\u003E.\u003C/li\u003E\n\u003C/ul\u003E\n\u003Cspan class=\"paragraph\"\u003EIn short, this model balances \u003Cstrong\u003Eaccuracy\u003C/strong\u003E and \u003Cstrong\u003Esparsity\u003C/strong\u003E, giving us predictive models that are both powerful and easy to interpret.\u003C/span\u003E\u003C/span\u003E"}, "type": "data"}]}, {"code_hash": "4fb5b85a49e4dd035b92b84ec067c1a0", "console": [], "id": "vblA", "outputs": [{"data": {"text/markdown": "\u003Cspan class=\"markdown prose dark:prose-invert contents\"\u003E\u003Cspan class=\"paragraph\"\u003EWe consider the following optimization problem:\u003C/span\u003E\n\u003Cmarimo-tex class=\"arithmatex\"\u003E||[\n\\min_{\\beta \\in \\mathbb{R}^p} \\;\\;\n\\|y - X\\beta\\|_2^2\n\\;+\\; \\lambda \\|\\beta\\|_2^2\n\\;+\\; \\mu \\|\\beta\\|_1\n||]\u003C/marimo-tex\u003E\u003Cmarimo-tex class=\"arithmatex\"\u003E||[\n\\quad \\text{s.t.} \\quad \\|\\beta\\|_0 \\leq k\n||]\u003C/marimo-tex\u003E\u003Cspan class=\"paragraph\"\u003Ewhere:\u003C/span\u003E\n\u003Cul\u003E\n\u003Cli\u003E\u003Cmarimo-tex class=\"arithmatex\"\u003E||(y \\in \\mathbb{R}^n||)\u003C/marimo-tex\u003E : response vector (observed outcomes).\u003C/li\u003E\n\u003Cli\u003E\u003Cmarimo-tex class=\"arithmatex\"\u003E||(X \\in \\mathbb{R}^{n \\times p}||)\u003C/marimo-tex\u003E : design (feature) matrix with \u003Cmarimo-tex class=\"arithmatex\"\u003E||(n||)\u003C/marimo-tex\u003E samples and \u003Cmarimo-tex class=\"arithmatex\"\u003E||(p||)\u003C/marimo-tex\u003E predictors.\u003C/li\u003E\n\u003Cli\u003E\u003Cmarimo-tex class=\"arithmatex\"\u003E||(\\lambda \\geq 0||)\u003C/marimo-tex\u003E : regularization parameter controlling the ridge penalty.\u003C/li\u003E\n\u003Cli\u003E\u003Cmarimo-tex class=\"arithmatex\"\u003E||(\\mu \\geq 0||)\u003C/marimo-tex\u003E : regularization parameter controlling the lasso penalty.\u003C/li\u003E\n\u003Cli\u003E\u003Cmarimo-tex class=\"arithmatex\"\u003E||(k||)\u003C/marimo-tex\u003E : sparsity level, i.e., maximum number of predictors allowed to be nonzero.\u003C/li\u003E\n\u003C/ul\u003E\u003C/span\u003E"}, "type": "data"}]}, {"code_hash": "6f48c984a837b9445d6fde206069befc", "console": [], "id": "bkHC", "outputs": [{"data": {"text/markdown": "\u003Cspan class=\"markdown prose dark:prose-invert contents\"\u003E\u003Cspan class=\"paragraph\"\u003EThis optimization problem extends least squares regression by adding two regularization terms and a sparsity constraint:\u003C/span\u003E\n\u003Cul\u003E\n\u003Cli\u003ESquared error term \u003Cmarimo-tex class=\"arithmatex\"\u003E||(\\|y - X\\beta\\|_2^2||)\u003C/marimo-tex\u003E: Penalizes discrepancies between predictions \u003Cmarimo-tex class=\"arithmatex\"\u003E||(X\\beta||)\u003C/marimo-tex\u003E and the observed responses \u003Cmarimo-tex class=\"arithmatex\"\u003E||(y||)\u003C/marimo-tex\u003E.\u003C/li\u003E\n\u003Cli\u003ERidge penalty \u003Cmarimo-tex class=\"arithmatex\"\u003E||(\\lambda \\|\\beta\\|_2^2||)\u003C/marimo-tex\u003E: Shrinks coefficient values to improve numerical stability and reduce overfitting (especially when predictors are correlated or \u003Cmarimo-tex class=\"arithmatex\"\u003E||(p||)\u003C/marimo-tex\u003E is large).\u003C/li\u003E\n\u003Cli\u003ELasso penalty \u003Cmarimo-tex class=\"arithmatex\"\u003E||(\\mu \\|\\beta\\|_1||)\u003C/marimo-tex\u003E: Encourages sparsity by shrinking some coefficients to zero.\u003C/li\u003E\n\u003Cli\u003ECardinality constraint \u003Cmarimo-tex class=\"arithmatex\"\u003E||(\\|\\beta\\|_0 \\leq k||)\u003C/marimo-tex\u003E: Limits the number of nonzero entries in \u003Cmarimo-tex class=\"arithmatex\"\u003E||(\\beta||)\u003C/marimo-tex\u003E to at most \u003Cmarimo-tex class=\"arithmatex\"\u003E||(k||)\u003C/marimo-tex\u003E, directly enforcing sparsity and interpretability.\u003C/li\u003E\n\u003C/ul\u003E\n\u003Cspan class=\"paragraph\"\u003EIn the model the cardinality constraint is usually problematic in application. This is a hard sparsity constraint and problems involving this count constraint are usually \u003Cem\u003ENP-Hard\u003C/em\u003E. Therefore instead of solving this model, the following transformation is applied.\u003C/span\u003E\n\u003Cspan class=\"paragraph\"\u003EIn the model the cardinality constraint is usually problematic in practice. This is a hard sparsity constraint, which forces the solution to include at most \ud835\udc58 nonzero coefficients. However, optimization problems with such a count constraint are generally NP-hard, since solving them requires searching through all possible subsets of predictors. Therefore, instead of solving this formulation directly, the model is often transformed or relaxed into an alternative form that can be solved efficiently.\u003C/span\u003E\u003C/span\u003E"}, "type": "data"}]}, {"code_hash": "8e9259fd3a331c7e6d08290c70463d19", "console": [], "id": "lEQa", "outputs": [{"data": {"text/markdown": "\u003Cspan class=\"markdown prose dark:prose-invert contents\"\u003E\u003Ch2 id=\"alternative-reformulation\"\u003EAlternative Reformulation\u003C/h2\u003E\u003C/span\u003E"}, "type": "data"}]}, {"code_hash": "36f78a4bea7665702725d3c4398796b2", "console": [], "id": "PKri", "outputs": [{"data": {"text/markdown": "\u003Cspan class=\"markdown prose dark:prose-invert contents\"\u003E\u003Cmarimo-tex class=\"arithmatex\"\u003E||[\n\\min_{\\beta \\in \\mathbb{R}^p}\\;\n\\|y - X\\beta\\|_2^2 \\;+\\; \\lambda \\|\\beta\\|_2^2 \\;+\\; \\mu \\|\\beta\\|_1\n\\quad \\text{s.t.}\\quad \\|\\beta\\|_0 \\le k .\n||]\u003C/marimo-tex\u003E\u003C/span\u003E"}, "type": "data"}]}, {"code_hash": "1be817b01357a64551af47ec29aabbbd", "console": [], "id": "Xref", "outputs": [{"data": {"text/markdown": "\u003Cspan class=\"markdown prose dark:prose-invert contents\"\u003E\u003Cspan class=\"paragraph\"\u003EAs the first step, expand the first two terms in the objective function. Through expansion one can see that we easily reach the general quadratic form.\u003C/span\u003E\n\u003Cmarimo-tex class=\"arithmatex\"\u003E||[\n\\|y - X\\beta\\|_2^2\n= y^\\top y - 2\\,y^\\top X\\beta + \\beta^\\top X^\\top X \\beta .\n||]\u003C/marimo-tex\u003E\u003Cspan class=\"paragraph\"\u003EThen the partial objective becomes:\u003C/span\u003E\n\u003Cmarimo-tex class=\"arithmatex\"\u003E||[\n\\|y - X\\beta\\|_2^2 + \\lambda\\|\\beta\\|_2^2\n= y^\\top y - 2\\,y^\\top X\\beta + \\beta^\\top (X^\\top X + \\lambda I)\\beta .\n||]\u003C/marimo-tex\u003E\u003C/span\u003E"}, "type": "data"}]}, {"code_hash": "2b313422d172380a2ed888166cfa4076", "console": [], "id": "SFPL", "outputs": [{"data": {"text/markdown": "\u003Cspan class=\"markdown prose dark:prose-invert contents\"\u003E\u003Cspan class=\"paragraph\"\u003EThe \u003Cmarimo-tex class=\"arithmatex\"\u003E||(\\ell_1||)\u003C/marimo-tex\u003E-norm \u003Cmarimo-tex class=\"arithmatex\"\u003E||(\\|\\beta\\|_1 = \\sum_{i=1}^p |\\beta_i|||)\u003C/marimo-tex\u003E is replaced by auxiliary variables \u003Cmarimo-tex class=\"arithmatex\"\u003E||(u_i \\ge 0||)\u003C/marimo-tex\u003E with constraints:\u003C/span\u003E\n\u003Cmarimo-tex class=\"arithmatex\"\u003E||[\n-u_i \\le \\beta_i \\le u_i .\n||]\u003C/marimo-tex\u003E\u003Cspan class=\"paragraph\"\u003EThese linear inequalities ensure \u003Cmarimo-tex class=\"arithmatex\"\u003E||(u_i \\ge |\\beta_i|||)\u003C/marimo-tex\u003E. Since the objective\nminimizes \u003Cmarimo-tex class=\"arithmatex\"\u003E||(\\sum_{i=1}^p u_i||)\u003C/marimo-tex\u003E, at optimality we have \u003Cmarimo-tex class=\"arithmatex\"\u003E||(u_i = |\\beta_i|||)\u003C/marimo-tex\u003E.\nThus,\u003C/span\u003E\n\u003Cmarimo-tex class=\"arithmatex\"\u003E||[\n\\|\\beta\\|_1 = \\sum_{i=1}^p u_i\n||]\u003C/marimo-tex\u003E\u003Cspan class=\"paragraph\"\u003Eis exactly represented in linear form.\u003C/span\u003E\u003C/span\u003E"}, "type": "data"}]}, {"code_hash": "a750fa1dbfe92287d2ec34492b0ef547", "console": [], "id": "BYtC", "outputs": [{"data": {"text/markdown": "\u003Cspan class=\"markdown prose dark:prose-invert contents\"\u003E\u003Cspan class=\"paragraph\"\u003ETo model the cardinality constraint \u003Cmarimo-tex class=\"arithmatex\"\u003E||(\\|\\beta\\|_0 \\le k||)\u003C/marimo-tex\u003E, we introduce binary\nindicator variables \u003Cmarimo-tex class=\"arithmatex\"\u003E||(z_i \\in \\{0,1\\}||)\u003C/marimo-tex\u003E for each coefficient. Formally,\n\u003Cmarimo-tex class=\"arithmatex\"\u003E||(z_i = 1||)\u003C/marimo-tex\u003E if \u003Cmarimo-tex class=\"arithmatex\"\u003E||(\\beta_i||)\u003C/marimo-tex\u003E is allowed to be nonzero, and \u003Cmarimo-tex class=\"arithmatex\"\u003E||(z_i = 0||)\u003C/marimo-tex\u003E if\n\u003Cmarimo-tex class=\"arithmatex\"\u003E||(\\beta_i||)\u003C/marimo-tex\u003E must be zero. Thus, every nonzero \u003Cmarimo-tex class=\"arithmatex\"\u003E||(\\beta_i||)\u003C/marimo-tex\u003E is \u003Cem\u003Ecounted\u003C/em\u003E\nthrough its corresponding indicator \u003Cmarimo-tex class=\"arithmatex\"\u003E||(z_i||)\u003C/marimo-tex\u003E.\u003C/span\u003E\n\u003Cspan class=\"paragraph\"\u003EThe constraint below ensures that at most \u003Cmarimo-tex class=\"arithmatex\"\u003E||(k||)\u003C/marimo-tex\u003E coefficients can be nonzero.\u003C/span\u003E\n\u003Cmarimo-tex class=\"arithmatex\"\u003E||[\n\\sum_{i=1}^p z_i \\le k\n||]\u003C/marimo-tex\u003E\u003Cspan class=\"paragraph\"\u003ETo enforce the connection between \u003Cmarimo-tex class=\"arithmatex\"\u003E||(\\beta_i||)\u003C/marimo-tex\u003E and its indicator \u003Cmarimo-tex class=\"arithmatex\"\u003E||(z_i||)\u003C/marimo-tex\u003E, one can impose:\u003C/span\u003E\n\u003Cmarimo-tex class=\"arithmatex\"\u003E||[\\beta_i (1 - z_i) = 0 \\quad \\text{for } i=1,\\dots,p||]\u003C/marimo-tex\u003E\u003Cspan class=\"paragraph\"\u003EThis guarantees the \u003Cem\u003Eeither\u2013or\u003C/em\u003E relationship: if \u003Cmarimo-tex class=\"arithmatex\"\u003E||(z_i=0||)\u003C/marimo-tex\u003E, then \u003Cmarimo-tex class=\"arithmatex\"\u003E||(\\beta_i = 0||)\u003C/marimo-tex\u003E, while if \u003Cmarimo-tex class=\"arithmatex\"\u003E||(z_i=1||)\u003C/marimo-tex\u003E, then \u003Cmarimo-tex class=\"arithmatex\"\u003E||(\\beta_i||)\u003C/marimo-tex\u003E is free to take a\nnonzero value. In this way, the challenge of the count operation can be worked around.\u003C/span\u003E\u003C/span\u003E"}, "type": "data"}]}, {"code_hash": "89207e7e83c64f69805fac4f5069f9c4", "console": [], "id": "RGSE", "outputs": [{"data": {"text/markdown": "\u003Cspan class=\"markdown prose dark:prose-invert contents\"\u003E\u003C/span\u003E"}, "type": "data"}]}, {"code_hash": "408e2ca1c64af4961a6926390243e46c", "console": [], "id": "Kclp", "outputs": [{"data": {"text/markdown": "\u003Cspan class=\"markdown prose dark:prose-invert contents\"\u003E\u003Cspan class=\"paragraph\"\u003EAt this point, to model the constraint\u003C/span\u003E\n\u003Cmarimo-tex class=\"arithmatex\"\u003E||[\n\\beta_i (1 - z_i) = 0, \\quad i=1,\\dots,p,\n||]\u003C/marimo-tex\u003E\u003Cspan class=\"paragraph\"\u003Ethe paper suggests introducing a \u003Cem\u003Ebig-\u003Cmarimo-tex class=\"arithmatex\"\u003E||(M||)\u003C/marimo-tex\u003E\u003C/em\u003E formulation. In that approach, large constants are used to relax the constraint and enforce the link between \u003Cmarimo-tex class=\"arithmatex\"\u003E||(\\beta_i||)\u003C/marimo-tex\u003E and \u003Cmarimo-tex class=\"arithmatex\"\u003E||(z_i||)\u003C/marimo-tex\u003E.\u003C/span\u003E\n\u003Cspan class=\"paragraph\"\u003EAfter the big-\u003Cmarimo-tex class=\"arithmatex\"\u003E||(M||)\u003C/marimo-tex\u003E value is fixed, the calculation becomes relatively easy to implement. However, \u003Cstrong\u003Edetermining a suitable big-\u003Cmarimo-tex class=\"arithmatex\"\u003E||(M||)\u003C/marimo-tex\u003E value is itself a challenge\u003C/strong\u003E. If \u003Cmarimo-tex class=\"arithmatex\"\u003E||(M||)\u003C/marimo-tex\u003E is chosen too small, the model may cut off feasible solutions. If \u003Cmarimo-tex class=\"arithmatex\"\u003E||(M||)\u003C/marimo-tex\u003E is chosen too large, the relaxation becomes weak and the solver may perform poorly. Therefore, based on the specific problem and the data at hand, an \u003Cstrong\u003Eappropriate big-\u003Cmarimo-tex class=\"arithmatex\"\u003E||(M||)\u003C/marimo-tex\u003E value must be determined each time\u003C/strong\u003E.\u003C/span\u003E\n\u003Cspan class=\"paragraph\"\u003EThere is no universal choice:\u003C/span\u003E\n\u003Cul\u003E\n\u003Cli\u003EThe bound should be large enough so that all feasible \u003Cmarimo-tex class=\"arithmatex\"\u003E||(\\beta_i||)\u003C/marimo-tex\u003E can be represented.\u003C/li\u003E\n\u003Cli\u003EBut it should not be excessively large, since that would weaken the relaxation and slow down the solver.\u003C/li\u003E\n\u003C/ul\u003E\n\u003Cspan class=\"paragraph\"\u003EBy contrast, \u003Cstrong\u003EMOSEK\u003C/strong\u003E has native support for \u003Cem\u003Edisjunctive constraints\u003C/em\u003E. This means we do not need to approximate with big-\u003Cmarimo-tex class=\"arithmatex\"\u003E||(M||)\u003C/marimo-tex\u003E. Instead, we can directly model the logical condition:\u003C/span\u003E\n\u003Cul\u003E\n\u003Cli\u003EEither \u003Cmarimo-tex class=\"arithmatex\"\u003E||(z_i = 1||)\u003C/marimo-tex\u003E (the variable \u003Cmarimo-tex class=\"arithmatex\"\u003E||(\\beta_i||)\u003C/marimo-tex\u003E is allowed to be nonzero),\u003C/li\u003E\n\u003Cli\u003EOr \u003Cmarimo-tex class=\"arithmatex\"\u003E||(\\beta_i = 0||)\u003C/marimo-tex\u003E (the variable is forced to zero when \u003Cmarimo-tex class=\"arithmatex\"\u003E||(z_i = 0||)\u003C/marimo-tex\u003E).\u003C/li\u003E\n\u003C/ul\u003E\n\u003Cspan class=\"paragraph\"\u003EThis way, the constraint is expressed exactly as an \u003Cstrong\u003Eeither\u2013or\u003C/strong\u003E condition, and MOSEK will internally handle the disjunction:\u003C/span\u003E\n\u003Cmarimo-tex class=\"arithmatex\"\u003E||[\n\\beta_i = 0 \\;\\;\\;\\; \\lor \\;\\;\\;\\; z_i = 1,\n\\quad i = 1,\\dots,p .\n||]\u003C/marimo-tex\u003E\u003C/span\u003E"}, "type": "data"}]}, {"code_hash": "613e412037c387cc740c7ec6a52302f7", "console": [], "id": "emfo", "outputs": [{"data": {"text/markdown": "\u003Cspan class=\"markdown prose dark:prose-invert contents\"\u003E\u003Cspan class=\"paragraph\"\u003EThen the final model becomes:\u003C/span\u003E\n\u003Cmarimo-tex class=\"arithmatex\"\u003E||[\n\\begin{aligned}\n\\min_{\\beta,u,z}\\quad\n\u0026amp; -\\,2\\,y^\\top X\\beta \\;+\\; \\beta^\\top (X^\\top X + \\lambda I)\\beta \\;+\\; \\mu \\sum_{i=1}^p u_i \\\\\n\\text{s.t.}\\quad\n\u0026amp; -u_i \\le \\beta_i \\le u_i,\\;\\; u_i \\ge 0, \\quad i=1,\\dots,p, \\\\\n\u0026amp; \\beta_i = 0 \\;\\;\\;\\; \\lor \\;\\;\\;\\; z_i = 1,\n\\quad i = 1,\\dots,p \\\\\n\u0026amp; \\sum_{i=1}^p z_i \\le k, \\quad z_i \\in \\{0,1\\}, \\;\\; i=1,\\dots,p, \\\\\n\u0026amp; \\beta \\in \\mathbb{R}^p,\\;\\; z \\in \\{0,1\\}^p,\\;\\; u \\in \\mathbb{R}_+^p.\n\\end{aligned}\n||]\u003C/marimo-tex\u003E\u003C/span\u003E"}, "type": "data"}]}, {"code_hash": "0a6c567ed460ade77533c6c93cd10a06", "console": [], "id": "Hstk", "outputs": [{"data": {"text/markdown": "\u003Cspan class=\"markdown prose dark:prose-invert contents\"\u003E\u003Ch2 id=\"model-implementation\"\u003EModel Implementation\u003C/h2\u003E\u003C/span\u003E"}, "type": "data"}]}, {"code_hash": "ff8e5621921428bb129c700889a354d7", "console": [], "id": "nWHF", "outputs": [{"data": {"text/markdown": "\u003Cspan class=\"markdown prose dark:prose-invert contents\"\u003E\u003Cspan class=\"paragraph\"\u003EThe objective we are minimizing has three types of terms:\u003C/span\u003E\n\u003Cmarimo-tex class=\"arithmatex\"\u003E||[\n-2y^\\top X \\beta \\;+\\; \\beta^\\top (X^\\top X + \\lambda I)\\beta \\;+\\; \\mu \\sum_i u_i \\;+\\; \\text{const.}\n||]\u003C/marimo-tex\u003E\u003Chr /\u003E\n\u003Ch2 id=\"1-linear-terms\"\u003E1. Linear terms:\u003C/h2\u003E\n\u003Cul\u003E\n\u003Cli\u003EThe scalar term \u003Cmarimo-tex class=\"arithmatex\"\u003E||(-2y^\\top X\\beta||)\u003C/marimo-tex\u003E is a simple inner product, i.e. linear in the decision variables \u003Cmarimo-tex class=\"arithmatex\"\u003E||(\\beta||)\u003C/marimo-tex\u003E.\u003C/li\u003E\n\u003Cli\u003EThe penalty \u003Cmarimo-tex class=\"arithmatex\"\u003E||(\\mu \\sum_i u_i||)\u003C/marimo-tex\u003E is also linear in the auxiliary variables \u003Cmarimo-tex class=\"arithmatex\"\u003E||(u_i||)\u003C/marimo-tex\u003E.\nThese can be added directly to the optimization model without special reformulation.\u003C/li\u003E\n\u003C/ul\u003E\n\u003Chr /\u003E\n\u003Ch2 id=\"2-quadratic-term\"\u003E2. Quadratic Term\u003C/h2\u003E\n\u003Cspan class=\"paragraph\"\u003EThe expression\u003C/span\u003E\n\u003Cmarimo-tex class=\"arithmatex\"\u003E||[\n\\beta^\\top (X^\\top X + \\lambda I)\\beta\n||]\u003C/marimo-tex\u003E\u003Cspan class=\"paragraph\"\u003Eis \u003Cstrong\u003Equadratic\u003C/strong\u003E.\nThere are \u003Cstrong\u003Etwo approaches\u003C/strong\u003E we can apply to handle it as a rotated second-order cone (RSOC) constraint.\u003C/span\u003E\n\u003Chr /\u003E\n\u003Ch3 id=\"option-1-cholesky-based-approach\"\u003EOption 1: Cholesky-based approach\u003C/h3\u003E\n\u003Cspan class=\"paragraph\"\u003ETo encode it in a conic optimization model, we introduce an auxiliary variable \u003Cmarimo-tex class=\"arithmatex\"\u003E||(t||)\u003C/marimo-tex\u003E representing the quadratic form:\u003C/span\u003E\n\u003Cmarimo-tex class=\"arithmatex\"\u003E||[\nt \\;\\ge\\; \\beta^\\top Q \\beta, \\quad Q = X^\\top X + \\lambda I\n||]\u003C/marimo-tex\u003E\u003Col\u003E\n\u003Cli\u003ESince \u003Cmarimo-tex class=\"arithmatex\"\u003E||(Q||)\u003C/marimo-tex\u003E is positive semidefinite we can perform a \u003Cstrong\u003ECholesky decomposition\u003C/strong\u003E:\u003C/li\u003E\n\u003C/ol\u003E\n\u003Cmarimo-tex class=\"arithmatex\"\u003E||[\nQ = L L^\\top\n||]\u003C/marimo-tex\u003E\u003Col start=\"2\"\u003E\n\u003Cli\u003EExpress the quadratic form as a norm:\u003C/li\u003E\n\u003C/ol\u003E\n\u003Cmarimo-tex class=\"arithmatex\"\u003E||[\n\\beta^\\top Q \\beta = \\| L^\\top \\beta \\|_2^2\n||]\u003C/marimo-tex\u003E\u003Col start=\"3\"\u003E\n\u003Cli\u003EEncode it as a \u003Cstrong\u003Erotated SOC constraint\u003C/strong\u003E:\u003C/li\u003E\n\u003C/ol\u003E\n\u003Cmarimo-tex class=\"arithmatex\"\u003E||[\n(1,\\; 0.5\\,t,\\; L^\\top \\beta) \\;\\in\\; \\mathcal{Q}_r\n||]\u003C/marimo-tex\u003E\u003Cspan class=\"paragraph\"\u003EThis enforces \u003Cmarimo-tex class=\"arithmatex\"\u003E||(t \\ge \\| L^\\top \\beta \\|_2^2||)\u003C/marimo-tex\u003E.\u003C/span\u003E\n\u003Chr /\u003E\n\u003Ch3 id=\"option-2-stacked-matrix-approach-no-cholesky\"\u003EOption 2: Stacked-matrix approach (no Cholesky)\u003C/h3\u003E\n\u003Cspan class=\"paragraph\"\u003EFirstly, let's introduce an auxiliary variable \u003Cmarimo-tex class=\"arithmatex\"\u003E||(t||)\u003C/marimo-tex\u003E representing the quadratic form again:\u003C/span\u003E\n\u003Cmarimo-tex class=\"arithmatex\"\u003E||[\nt \\;\\ge\\; \\beta^\\top (X^\\top X + \\lambda I)\\beta\n||]\u003C/marimo-tex\u003E\u003Col\u003E\n\u003Cli\u003EStack \u003Cmarimo-tex class=\"arithmatex\"\u003E||(X||)\u003C/marimo-tex\u003E and \u003Cmarimo-tex class=\"arithmatex\"\u003E||(\\sqrt{\\lambda} I||)\u003C/marimo-tex\u003E vertically:\u003C/li\u003E\n\u003C/ol\u003E\n\u003Cmarimo-tex class=\"arithmatex\"\u003E||[\n\\begin{bmatrix} X \\\\ \\sqrt{\\lambda} I \\end{bmatrix}\n||]\u003C/marimo-tex\u003E\u003Col start=\"2\"\u003E\n\u003Cli\u003EExpress the quadratic form as a norm:\u003C/li\u003E\n\u003C/ol\u003E\n\u003Cmarimo-tex class=\"arithmatex\"\u003E||[\n\\beta^\\top (X^\\top X + \\lambda I) \\beta = \\left\\| \\begin{bmatrix} X \\\\ \\sqrt{\\lambda} I \\end{bmatrix} \\beta \\right\\|_2^2\n||]\u003C/marimo-tex\u003E\u003Col start=\"3\"\u003E\n\u003Cli\u003EIntroduce a scalar variable \u003Cmarimo-tex class=\"arithmatex\"\u003E||(t \\ge \\| [X; \\sqrt{\\lambda} I] \\beta \\|_2||)\u003C/marimo-tex\u003E and write as a \u003Cstrong\u003Erotated SOC constraint\u003C/strong\u003E:\u003C/li\u003E\n\u003C/ol\u003E\n\u003Cmarimo-tex class=\"arithmatex\"\u003E||[\n\\left(1, \\frac{t}{2}, \\begin{bmatrix} X \\\\ \\sqrt{\\lambda} I \\end{bmatrix} \\beta \\right) \\;\\in\\; \\mathcal{Q}_r\n||]\u003C/marimo-tex\u003E\u003Cspan class=\"paragraph\"\u003EThis approach avoids Cholesky factorization and works well when \u003Cmarimo-tex class=\"arithmatex\"\u003E||(X||)\u003C/marimo-tex\u003E is sparse.\u003C/span\u003E\n\u003Chr /\u003E\n\u003Cspan class=\"paragraph\"\u003E\u003Cstrong\u003ENote on selection:\u003C/strong\u003E\u003C/span\u003E\n\u003Cul\u003E\n\u003Cli\u003EIf \u003Cmarimo-tex class=\"arithmatex\"\u003E||(X||)\u003C/marimo-tex\u003E is \u003Cstrong\u003Edense\u003C/strong\u003E, the Cholesky-based approach is usually faster and more efficient.\u003C/li\u003E\n\u003Cli\u003EIf \u003Cmarimo-tex class=\"arithmatex\"\u003E||(X||)\u003C/marimo-tex\u003E is \u003Cstrong\u003Esparse\u003C/strong\u003E, the stacked-matrix approach is preferred.\u003C/li\u003E\n\u003C/ul\u003E\n\u003Cspan class=\"paragraph\"\u003EThe choice depends on the \u003Cstrong\u003Estructure of \u003Cmarimo-tex class=\"arithmatex\"\u003E||(X||)\u003C/marimo-tex\u003E\u003C/strong\u003E and the \u003Cstrong\u003Esolver/data requirements\u003C/strong\u003E.\u003C/span\u003E\n\u003Ch2 id=\"3-putting-it-together\"\u003E3. Putting it together:\u003C/h2\u003E\n\u003Cul\u003E\n\u003Cli\u003EThe final objective is linear in \u003Cmarimo-tex class=\"arithmatex\"\u003E||(\\beta, u, t||)\u003C/marimo-tex\u003E.\u003C/li\u003E\n\u003Cli\u003EThe only nonlinear part \u003Cmarimo-tex class=\"arithmatex\"\u003E||(\\beta^\\top Q \\beta||)\u003C/marimo-tex\u003E has been reformulated into a \u003Cstrong\u003Econe constraint\u003C/strong\u003E, so the solver can handle it efficiently.\u003C/li\u003E\n\u003C/ul\u003E\u003C/span\u003E"}, "type": "data"}]}, {"code_hash": "37a5288c583b3623139e849de153b4e2", "console": [], "id": "iLit", "outputs": [{"data": {"text/markdown": "\u003Cspan class=\"markdown prose dark:prose-invert contents\"\u003E\u003Ch1 id=\"implementing-the-model-in-python\"\u003EImplementing the model in Python\u003C/h1\u003E\u003C/span\u003E"}, "type": "data"}]}, {"code_hash": "05b62f0e72274bed5a6e262c51876411", "console": [], "id": "ZHCJ", "outputs": [{"data": {"text/markdown": "\u003Cspan class=\"markdown prose dark:prose-invert contents\"\u003E\u003Cspan class=\"paragraph\"\u003EThe following function implements the model described earlier.\u003C/span\u003E\n\u003Cspan class=\"paragraph\"\u003EThe quadratic term can be handled using \u003Cstrong\u003Eeither of the two approaches\u003C/strong\u003E depending on the user\u2019s preference and the input data:\u003C/span\u003E\n\u003Cul\u003E\n\u003Cli\u003EIf the user sets \u003Ccode\u003Echolesky = True\u003C/code\u003E (the \u003Cstrong\u003Edefault\u003C/strong\u003E), the function uses the \u003Cstrong\u003ECholesky-based transformation\u003C/strong\u003E (Option 1).\u003C/li\u003E\n\u003Cli\u003EIf the user sets \u003Ccode\u003Echolesky = False\u003C/code\u003E, the function uses the \u003Cstrong\u003Estacked-matrix transformation\u003C/strong\u003E (Option 2).\u003C/li\u003E\n\u003C/ul\u003E\n\u003Cspan class=\"paragraph\"\u003EThis design allows the model to adapt to the structure of the input data and the user\u2019s requirements while keeping the implementation flexible.\u003C/span\u003E\u003C/span\u003E"}, "type": "data"}]}, {"code_hash": "4b7f73eedfa3b34265088840199c4fbc", "console": [], "id": "ROlb", "outputs": [{"data": {"text/plain": ""}, "type": "data"}]}, {"code_hash": "f38f804b18e456693bdd8982eab011f0", "console": [], "id": "qnkX", "outputs": [{"data": {"text/markdown": "\u003Cspan class=\"markdown prose dark:prose-invert contents\"\u003E\u003Cspan class=\"paragraph\"\u003EThe described model is implemented using Mosek above.\u003C/span\u003E\n\u003Cdiv class=\"language-python codehilite\"\u003E\u003Cpre\u003E\u003Cspan\u003E\u003C/span\u003E\u003Ccode\u003E    \u003Cspan class=\"n\"\u003EM\u003C/span\u003E\u003Cspan class=\"o\"\u003E.\u003C/span\u003E\u003Cspan class=\"n\"\u003Edisjunction\u003C/span\u003E\u003Cspan class=\"p\"\u003E((\u003C/span\u003E\u003Cspan class=\"n\"\u003Ez\u003C/span\u003E \u003Cspan class=\"o\"\u003E==\u003C/span\u003E \u003Cspan class=\"mi\"\u003E1\u003C/span\u003E\u003Cspan class=\"p\"\u003E)\u003C/span\u003E \u003Cspan class=\"o\"\u003E|\u003C/span\u003E \u003Cspan class=\"p\"\u003E(\u003C/span\u003E\u003Cspan class=\"n\"\u003EB\u003C/span\u003E \u003Cspan class=\"o\"\u003E==\u003C/span\u003E \u003Cspan class=\"mi\"\u003E0\u003C/span\u003E\u003Cspan class=\"p\"\u003E))\u003C/span\u003E\n\u003C/code\u003E\u003C/pre\u003E\u003C/div\u003E\n\u003Cspan class=\"paragraph\"\u003EThe line above illustrates how \u003Cstrong\u003EMosek can implement disjunction constraints\u003C/strong\u003E without requiring any additional transformations, such as using Big-M values.\u003C/span\u003E\n\u003Cspan class=\"paragraph\"\u003ETo run the model, we use the \u003Cem\u003Ediabetes dataset\u003C/em\u003E shared by the referenced paper. We download, and load the dataset online in the code block below.\u003C/span\u003E\u003C/span\u003E"}, "type": "data"}]}, {"code_hash": "599a334623051a4a62235e5e6ed4d5b5", "console": [], "id": "TqIu", "outputs": [{"data": {"text/markdown": "\u003Cspan class=\"markdown prose dark:prose-invert contents\"\u003E\u003Ch2 id=\"loading-the-data\"\u003ELoading the Data\u003C/h2\u003E\u003C/span\u003E"}, "type": "data"}]}, {"code_hash": "cd1a338cdae1a1283112c5a5f94126ea", "console": [{"mimetype": "text/plain", "name": "stdout", "text": "Using file: data_sparse_regression/data.sparse.regression/diabetesQ.csv\nColumns in dataset: ['age', 'sex', 'bmi', 'map', 'tc', 'ldl', 'hdl', 'tch', 'ltg', 'glu', 'age^2', 'bmi^2', 'map^2', 'tc^2', 'ldl^2', 'hdl^2', 'tch^2', 'ltg^2', 'glu^2', 'age:sex', 'age:bmi', 'age:map', 'age:tc', 'age:ldl', 'age:hdl', 'age:tch', 'age:ltg', 'age:glu', 'sex:bmi', 'sex:map', 'sex:tc', 'sex:ldl', 'sex:hdl', 'sex:tch', 'sex:ltg', 'sex:glu', 'bmi:map', 'bmi:tc', 'bmi:ldl', 'bmi:hdl', 'bmi:tch', 'bmi:ltg', 'bmi:glu', 'map:tc', 'map:ldl', 'map:hdl', 'map:tch', 'map:ltg', 'map:glu', 'tc:ldl', 'tc:hdl', 'tc:tch', 'tc:ltg', 'tc:glu', 'ldl:hdl', 'ldl:tch', 'ldl:ltg', 'ldl:glu', 'hdl:tch', 'hdl:ltg', 'hdl:glu', 'tch:ltg', 'tch:glu', 'ltg:glu', 'y']\nShape of X (features): (442, 64)\nShape of y (target): (442,)\n", "type": "stream"}], "id": "Vxnm", "outputs": [{"data": {"text/plain": ""}, "type": "data"}]}, {"code_hash": "5690bd9bad250f88d1f70cd33bed21b7", "console": [], "id": "DnEU", "outputs": [{"data": {"text/markdown": "\u003Cspan class=\"markdown prose dark:prose-invert contents\"\u003E\u003Cspan class=\"paragraph\"\u003EThen using the loaded data, we can run the problem. As it can be seen from the printed out message below, the model is solved to feasibility.\u003C/span\u003E\u003C/span\u003E"}, "type": "data"}]}, {"code_hash": "4d03f7a6098f4c07eef68ec63f2ea964", "console": [{"mimetype": "text/plain", "name": "stdout", "text": "Elapsed Time: 0.2148 s\nObjective value: 2621009.1244\nModel Status:  SolutionStatus.Optimal\n", "type": "stream"}], "id": "ulZA", "outputs": [{"data": {"text/html": "\u003Cpre class='text-xs'\u003Emosek.fusion.Model\u003C/pre\u003E"}, "type": "data"}]}], "metadata": {"marimo_version": "0.18.4"}, "version": "1"},
            "runtimeConfig": null,
        };
    </script>
  
<marimo-code hidden="">
    import%20marimo%0A%0A__generated_with%20%3D%20%220.18.4%22%0Aapp%20%3D%20marimo.App(width%3D%22medium%22)%0A%0A%0A%40app.cell(hide_code%3DTrue)%0Adef%20_()%3A%0A%20%20%20%20import%20marimo%20as%20mo%0A%20%20%20%20import%20numpy%20as%20np%0A%20%20%20%20from%20mosek.fusion%20import%20Model%2C%20Domain%2C%20Expr%2C%20ObjectiveSense%2C%20Matrix%2C%20Var%0A%20%20%20%20import%20mosek.fusion.pythonic%0A%20%20%20%20import%20sys%0A%20%20%20%20import%20requests%2C%20zipfile%2C%20io%2C%20os%2C%20glob%0A%20%20%20%20from%20sklearn.preprocessing%20import%20StandardScaler%0A%20%20%20%20import%20pandas%20as%20pd%0A%20%20%20%20import%20time%0A%20%20%20%20return%20(%0A%20%20%20%20%20%20%20%20Domain%2C%0A%20%20%20%20%20%20%20%20Expr%2C%0A%20%20%20%20%20%20%20%20Model%2C%0A%20%20%20%20%20%20%20%20ObjectiveSense%2C%0A%20%20%20%20%20%20%20%20StandardScaler%2C%0A%20%20%20%20%20%20%20%20glob%2C%0A%20%20%20%20%20%20%20%20io%2C%0A%20%20%20%20%20%20%20%20mo%2C%0A%20%20%20%20%20%20%20%20np%2C%0A%20%20%20%20%20%20%20%20os%2C%0A%20%20%20%20%20%20%20%20pd%2C%0A%20%20%20%20%20%20%20%20requests%2C%0A%20%20%20%20%20%20%20%20time%2C%0A%20%20%20%20%20%20%20%20zipfile%2C%0A%20%20%20%20)%0A%0A%0A%40app.cell(hide_code%3DTrue)%0Adef%20_(mo)%3A%0A%20%20%20%20mo.md(r%22%22%22%0A%20%20%20%20%23%20Rank-One%20Sparse%20Regression%20Model%0A%0A%20%20%20%20This%20notebook%20is%20based%20on%20%5BRank-one%20Convexification%20for%20Sparse%20Regression%5D(https%3A%2F%2Farxiv.org%2Fabs%2F1901.10334)%20by%20Atamt%C3%BCrk%20and%20G%C3%B3mez.%0A%0A%20%20%20%20In%20the%20paper%20a%20model%20is%20designed%20to%20solve%20regression%20problems%20when%20the%20number%20of%20predictors%20is%20large%20and%20we%20expect%20only%20a%20small%20subset%20of%20them%20to%20be%20truly%20relevant.%20This%20model%20combines%20**quadratic%20loss%20minimization**%20with%20a%20**sparsity-inducing%20penalty**%20and%20a%20**conic%20reformulation**%20that%20makes%20the%20optimization%20problem%20tractable.%20Some%20properties%20this%20model%20offers%20to%20users%3A%0A%0A%20%20%20%20-%20**Feature%20selection**%3A%20It%20automatically%20selects%20only%20the%20most%20relevant%20predictors.%0A%20%20%20%20-%20**Interpretability**%3A%20Produces%20simpler%2C%20more%20interpretable%20models.%0A%20%20%20%20-%20**Regularization**%3A%20Prevents%20overfitting%20by%20discouraging%20unnecessarily%20large%20coefficients.%0A%20%20%20%20-%20**High-dimensional%20settings**%3A%20Particularly%20useful%20when%20the%20number%20of%20predictors%20%5C(p%5C)%20is%20large%20compared%20to%20the%20number%20of%20samples%20%5C(n%5C).%0A%0A%20%20%20%20In%20short%2C%20this%20model%20balances%20**accuracy**%20and%20**sparsity**%2C%20giving%20us%20predictive%20models%20that%20are%20both%20powerful%20and%20easy%20to%20interpret.%0A%20%20%20%20%22%22%22)%0A%20%20%20%20return%0A%0A%0A%40app.cell(hide_code%3DTrue)%0Adef%20_(mo)%3A%0A%20%20%20%20mo.md(r%22%22%22%0A%20%20%20%20We%20consider%20the%20following%20optimization%20problem%3A%0A%0A%20%20%20%20%5C%5B%0A%20%20%20%20%5Cmin_%7B%5Cbeta%20%5Cin%20%5Cmathbb%7BR%7D%5Ep%7D%20%5C%3B%5C%3B%0A%20%20%20%20%5C%7Cy%20-%20X%5Cbeta%5C%7C_2%5E2%0A%20%20%20%20%5C%3B%2B%5C%3B%20%5Clambda%20%5C%7C%5Cbeta%5C%7C_2%5E2%0A%20%20%20%20%5C%3B%2B%5C%3B%20%5Cmu%20%5C%7C%5Cbeta%5C%7C_1%0A%20%20%20%20%5C%5D%0A%0A%20%20%20%20%5C%5B%0A%20%20%20%20%5Cquad%20%5Ctext%7Bs.t.%7D%20%5Cquad%20%5C%7C%5Cbeta%5C%7C_0%20%5Cleq%20k%0A%20%20%20%20%5C%5D%0A%0A%20%20%20%20where%3A%0A%0A%20%20%20%20-%20%5C(y%20%5Cin%20%5Cmathbb%7BR%7D%5En%5C)%20%3A%20response%20vector%20(observed%20outcomes).%0A%20%20%20%20-%20%5C(X%20%5Cin%20%5Cmathbb%7BR%7D%5E%7Bn%20%5Ctimes%20p%7D%5C)%20%3A%20design%20(feature)%20matrix%20with%20%5C(n%5C)%20samples%20and%20%5C(p%5C)%20predictors.%0A%20%20%20%20-%20%5C(%5Clambda%20%5Cgeq%200%5C)%20%3A%20regularization%20parameter%20controlling%20the%20ridge%20penalty.%0A%20%20%20%20-%20%5C(%5Cmu%20%5Cgeq%200%5C)%20%3A%20regularization%20parameter%20controlling%20the%20lasso%20penalty.%0A%20%20%20%20-%20%5C(k%5C)%20%3A%20sparsity%20level%2C%20i.e.%2C%20maximum%20number%20of%20predictors%20allowed%20to%20be%20nonzero.%0A%20%20%20%20%22%22%22)%0A%20%20%20%20return%0A%0A%0A%40app.cell(hide_code%3DTrue)%0Adef%20_(mo)%3A%0A%20%20%20%20mo.md(r%22%22%22%0A%20%20%20%20This%20optimization%20problem%20extends%20least%20squares%20regression%20by%20adding%20two%20regularization%20terms%20and%20a%20sparsity%20constraint%3A%0A%0A%20%20%20%20-%20Squared%20error%20term%20%24%5C%7Cy%20-%20X%5Cbeta%5C%7C_2%5E2%24%3A%20Penalizes%20discrepancies%20between%20predictions%20%24X%5Cbeta%24%20and%20the%20observed%20responses%20%24y%24.%0A%0A%20%20%20%20-%20Ridge%20penalty%20%24%5Clambda%20%5C%7C%5Cbeta%5C%7C_2%5E2%24%3A%20Shrinks%20coefficient%20values%20to%20improve%20numerical%20stability%20and%20reduce%20overfitting%20(especially%20when%20predictors%20are%20correlated%20or%20%24p%24%20is%20large).%0A%0A%20%20%20%20-%20Lasso%20penalty%20%24%5Cmu%20%5C%7C%5Cbeta%5C%7C_1%24%3A%20Encourages%20sparsity%20by%20shrinking%20some%20coefficients%20to%20zero.%0A%0A%20%20%20%20-%20Cardinality%20constraint%20%24%5C%7C%5Cbeta%5C%7C_0%20%5Cleq%20k%24%3A%20Limits%20the%20number%20of%20nonzero%20entries%20in%20%24%5Cbeta%24%20to%20at%20most%20%24k%24%2C%20directly%20enforcing%20sparsity%20and%20interpretability.%0A%0A%0A%20%20%20%20In%20the%20model%20the%20cardinality%20constraint%20is%20usually%20problematic%20in%20application.%20This%20is%20a%20hard%20sparsity%20constraint%20and%20problems%20involving%20this%20count%20constraint%20are%20usually%20*NP-Hard*.%20Therefore%20instead%20of%20solving%20this%20model%2C%20the%20following%20transformation%20is%20applied.%0A%0A%20%20%20%20In%20the%20model%20the%20cardinality%20constraint%20is%20usually%20problematic%20in%20practice.%20This%20is%20a%20hard%20sparsity%20constraint%2C%20which%20forces%20the%20solution%20to%20include%20at%20most%20%F0%9D%91%98%20nonzero%20coefficients.%20However%2C%20optimization%20problems%20with%20such%20a%20count%20constraint%20are%20generally%20NP-hard%2C%20since%20solving%20them%20requires%20searching%20through%20all%20possible%20subsets%20of%20predictors.%20Therefore%2C%20instead%20of%20solving%20this%20formulation%20directly%2C%20the%20model%20is%20often%20transformed%20or%20relaxed%20into%20an%20alternative%20form%20that%20can%20be%20solved%20efficiently.%0A%20%20%20%20%22%22%22)%0A%20%20%20%20return%0A%0A%0A%40app.cell(hide_code%3DTrue)%0Adef%20_(mo)%3A%0A%20%20%20%20mo.md(r%22%22%22%0A%20%20%20%20%23%23%20Alternative%20Reformulation%0A%20%20%20%20%22%22%22)%0A%20%20%20%20return%0A%0A%0A%40app.cell(hide_code%3DTrue)%0Adef%20_(mo)%3A%0A%20%20%20%20mo.md(r%22%22%22%0A%20%20%20%20%24%24%0A%20%20%20%20%5Cmin_%7B%5Cbeta%20%5Cin%20%5Cmathbb%7BR%7D%5Ep%7D%5C%3B%0A%20%20%20%20%5C%7Cy%20-%20X%5Cbeta%5C%7C_2%5E2%20%5C%3B%2B%5C%3B%20%5Clambda%20%5C%7C%5Cbeta%5C%7C_2%5E2%20%5C%3B%2B%5C%3B%20%5Cmu%20%5C%7C%5Cbeta%5C%7C_1%0A%20%20%20%20%5Cquad%20%5Ctext%7Bs.t.%7D%5Cquad%20%5C%7C%5Cbeta%5C%7C_0%20%5Cle%20k%20.%0A%20%20%20%20%24%24%0A%20%20%20%20%22%22%22)%0A%20%20%20%20return%0A%0A%0A%40app.cell(hide_code%3DTrue)%0Adef%20_(mo)%3A%0A%20%20%20%20mo.md(r%22%22%22%0A%20%20%20%20As%20the%20first%20step%2C%20expand%20the%20first%20two%20terms%20in%20the%20objective%20function.%20Through%20expansion%20one%20can%20see%20that%20we%20easily%20reach%20the%20general%20quadratic%20form.%0A%0A%20%20%20%20%24%24%0A%20%20%20%20%5C%7Cy%20-%20X%5Cbeta%5C%7C_2%5E2%0A%20%20%20%20%3D%20y%5E%5Ctop%20y%20-%202%5C%2Cy%5E%5Ctop%20X%5Cbeta%20%2B%20%5Cbeta%5E%5Ctop%20X%5E%5Ctop%20X%20%5Cbeta%20.%0A%20%20%20%20%24%24%0A%0A%20%20%20%20Then%20the%20partial%20objective%20becomes%3A%0A%0A%20%20%20%20%24%24%0A%20%20%20%20%5C%7Cy%20-%20X%5Cbeta%5C%7C_2%5E2%20%2B%20%5Clambda%5C%7C%5Cbeta%5C%7C_2%5E2%0A%20%20%20%20%3D%20y%5E%5Ctop%20y%20-%202%5C%2Cy%5E%5Ctop%20X%5Cbeta%20%2B%20%5Cbeta%5E%5Ctop%20(X%5E%5Ctop%20X%20%2B%20%5Clambda%20I)%5Cbeta%20.%0A%20%20%20%20%24%24%0A%20%20%20%20%22%22%22)%0A%20%20%20%20return%0A%0A%0A%40app.cell(hide_code%3DTrue)%0Adef%20_(mo)%3A%0A%20%20%20%20mo.md(r%22%22%22%0A%20%20%20%20The%20%24%5Cell_1%24-norm%20%24%5C%7C%5Cbeta%5C%7C_1%20%3D%20%5Csum_%7Bi%3D1%7D%5Ep%20%7C%5Cbeta_i%7C%24%20is%20replaced%20by%20auxiliary%20variables%20%24u_i%20%5Cge%200%24%20with%20constraints%3A%0A%0A%20%20%20%20%5C%5B%0A%20%20%20%20-u_i%20%5Cle%20%5Cbeta_i%20%5Cle%20u_i%20.%0A%20%20%20%20%5C%5D%0A%0A%20%20%20%20These%20linear%20inequalities%20ensure%20%24u_i%20%5Cge%20%7C%5Cbeta_i%7C%24.%20Since%20the%20objective%0A%20%20%20%20minimizes%20%24%5Csum_%7Bi%3D1%7D%5Ep%20u_i%24%2C%20at%20optimality%20we%20have%20%24u_i%20%3D%20%7C%5Cbeta_i%7C%24.%0A%20%20%20%20Thus%2C%0A%0A%20%20%20%20%5C%5B%0A%20%20%20%20%5C%7C%5Cbeta%5C%7C_1%20%3D%20%5Csum_%7Bi%3D1%7D%5Ep%20u_i%0A%20%20%20%20%5C%5D%0A%0A%20%20%20%20is%20exactly%20represented%20in%20linear%20form.%0A%20%20%20%20%22%22%22)%0A%20%20%20%20return%0A%0A%0A%40app.cell(hide_code%3DTrue)%0Adef%20_(mo)%3A%0A%20%20%20%20mo.md(r%22%22%22%0A%20%20%20%20To%20model%20the%20cardinality%20constraint%20%24%5C%7C%5Cbeta%5C%7C_0%20%5Cle%20k%24%2C%20we%20introduce%20binary%0A%20%20%20%20indicator%20variables%20%24z_i%20%5Cin%20%5C%7B0%2C1%5C%7D%24%20for%20each%20coefficient.%20Formally%2C%0A%20%20%20%20%24z_i%20%3D%201%24%20if%20%24%5Cbeta_i%24%20is%20allowed%20to%20be%20nonzero%2C%20and%20%24z_i%20%3D%200%24%20if%0A%20%20%20%20%24%5Cbeta_i%24%20must%20be%20zero.%20Thus%2C%20every%20nonzero%20%24%5Cbeta_i%24%20is%20*counted*%0A%20%20%20%20through%20its%20corresponding%20indicator%20%24z_i%24.%0A%0A%20%20%20%20The%20constraint%20below%20ensures%20that%20at%20most%20%24k%24%20coefficients%20can%20be%20nonzero.%0A%0A%20%20%20%20%5C%5B%0A%20%20%20%20%5Csum_%7Bi%3D1%7D%5Ep%20z_i%20%5Cle%20k%0A%20%20%20%20%5C%5D%0A%0A%0A%20%20%20%20To%20enforce%20the%20connection%20between%20%24%5Cbeta_i%24%20and%20its%20indicator%20%24z_i%24%2C%20one%20can%20impose%3A%0A%0A%20%20%20%20%5C%5B%5Cbeta_i%20(1%20-%20z_i)%20%3D%200%20%5Cquad%20%5Ctext%7Bfor%20%7D%20i%3D1%2C%5Cdots%2Cp%5C%5D%0A%0A%20%20%20%20This%20guarantees%20the%20*either%E2%80%93or*%20relationship%3A%20if%20%24z_i%3D0%24%2C%20then%20%24%5Cbeta_i%20%3D%200%24%2C%20while%20if%20%24z_i%3D1%24%2C%20then%20%24%5Cbeta_i%24%20is%20free%20to%20take%20a%0A%20%20%20%20nonzero%20value.%20In%20this%20way%2C%20the%20challenge%20of%20the%20count%20operation%20can%20be%20worked%20around.%0A%20%20%20%20%22%22%22)%0A%20%20%20%20return%0A%0A%0A%40app.cell(hide_code%3DTrue)%0Adef%20_(mo)%3A%0A%20%20%20%20mo.md(r%22%22%22%20%22%22%22)%0A%20%20%20%20return%0A%0A%0A%40app.cell(hide_code%3DTrue)%0Adef%20_(mo)%3A%0A%20%20%20%20mo.md(r%22%22%22%0A%20%20%20%20At%20this%20point%2C%20to%20model%20the%20constraint%0A%0A%20%20%20%20%24%24%0A%20%20%20%20%5Cbeta_i%20(1%20-%20z_i)%20%3D%200%2C%20%5Cquad%20i%3D1%2C%5Cdots%2Cp%2C%0A%20%20%20%20%24%24%0A%0A%20%20%20%20the%20paper%20suggests%20introducing%20a%20*big-%24M%24*%20formulation.%20In%20that%20approach%2C%20large%20constants%20are%20used%20to%20relax%20the%20constraint%20and%20enforce%20the%20link%20between%20%24%5Cbeta_i%24%20and%20%24z_i%24.%0A%0A%20%20%20%20After%20the%20big-%24M%24%20value%20is%20fixed%2C%20the%20calculation%20becomes%20relatively%20easy%20to%20implement.%20However%2C%20**determining%20a%20suitable%20big-%24M%24%20value%20is%20itself%20a%20challenge**.%20If%20%24M%24%20is%20chosen%20too%20small%2C%20the%20model%20may%20cut%20off%20feasible%20solutions.%20If%20%24M%24%20is%20chosen%20too%20large%2C%20the%20relaxation%20becomes%20weak%20and%20the%20solver%20may%20perform%20poorly.%20Therefore%2C%20based%20on%20the%20specific%20problem%20and%20the%20data%20at%20hand%2C%20an%20**appropriate%20big-%24M%24%20value%20must%20be%20determined%20each%20time**.%0A%0A%20%20%20%20There%20is%20no%20universal%20choice%3A%0A%20%20%20%20-%20The%20bound%20should%20be%20large%20enough%20so%20that%20all%20feasible%20%24%5Cbeta_i%24%20can%20be%20represented.%0A%20%20%20%20-%20But%20it%20should%20not%20be%20excessively%20large%2C%20since%20that%20would%20weaken%20the%20relaxation%20and%20slow%20down%20the%20solver.%0A%0A%0A%20%20%20%20By%20contrast%2C%20**MOSEK**%20has%20native%20support%20for%20*disjunctive%20constraints*.%20This%20means%20we%20do%20not%20need%20to%20approximate%20with%20big-%24M%24.%20Instead%2C%20we%20can%20directly%20model%20the%20logical%20condition%3A%0A%0A%20%20%20%20-%20Either%20%24z_i%20%3D%201%24%20(the%20variable%20%24%5Cbeta_i%24%20is%20allowed%20to%20be%20nonzero)%2C%0A%20%20%20%20-%20Or%20%24%5Cbeta_i%20%3D%200%24%20(the%20variable%20is%20forced%20to%20zero%20when%20%24z_i%20%3D%200%24).%0A%0A%20%20%20%20This%20way%2C%20the%20constraint%20is%20expressed%20exactly%20as%20an%20**either%E2%80%93or**%20condition%2C%20and%20MOSEK%20will%20internally%20handle%20the%20disjunction%3A%0A%0A%20%20%20%20%5C%5B%0A%20%20%20%20%5Cbeta_i%20%3D%200%20%5C%3B%5C%3B%5C%3B%5C%3B%20%5Clor%20%5C%3B%5C%3B%5C%3B%5C%3B%20z_i%20%3D%201%2C%0A%20%20%20%20%5Cquad%20i%20%3D%201%2C%5Cdots%2Cp%20.%0A%20%20%20%20%5C%5D%0A%20%20%20%20%22%22%22)%0A%20%20%20%20return%0A%0A%0A%40app.cell(hide_code%3DTrue)%0Adef%20_(mo)%3A%0A%20%20%20%20mo.md(r%22%22%22%0A%20%20%20%20Then%20the%20final%20model%20becomes%3A%0A%0A%20%20%20%20%24%24%0A%20%20%20%20%5Cbegin%7Baligned%7D%0A%20%20%20%20%5Cmin_%7B%5Cbeta%2Cu%2Cz%7D%5Cquad%0A%20%20%20%20%26%20-%5C%2C2%5C%2Cy%5E%5Ctop%20X%5Cbeta%20%5C%3B%2B%5C%3B%20%5Cbeta%5E%5Ctop%20(X%5E%5Ctop%20X%20%2B%20%5Clambda%20I)%5Cbeta%20%5C%3B%2B%5C%3B%20%5Cmu%20%5Csum_%7Bi%3D1%7D%5Ep%20u_i%20%5C%5C%0A%20%20%20%20%5Ctext%7Bs.t.%7D%5Cquad%0A%20%20%20%20%26%20-u_i%20%5Cle%20%5Cbeta_i%20%5Cle%20u_i%2C%5C%3B%5C%3B%20u_i%20%5Cge%200%2C%20%5Cquad%20i%3D1%2C%5Cdots%2Cp%2C%20%5C%5C%0A%20%20%20%20%26%20%5Cbeta_i%20%3D%200%20%5C%3B%5C%3B%5C%3B%5C%3B%20%5Clor%20%5C%3B%5C%3B%5C%3B%5C%3B%20z_i%20%3D%201%2C%0A%20%20%20%20%5Cquad%20i%20%3D%201%2C%5Cdots%2Cp%20%5C%5C%0A%20%20%20%20%26%20%5Csum_%7Bi%3D1%7D%5Ep%20z_i%20%5Cle%20k%2C%20%5Cquad%20z_i%20%5Cin%20%5C%7B0%2C1%5C%7D%2C%20%5C%3B%5C%3B%20i%3D1%2C%5Cdots%2Cp%2C%20%5C%5C%0A%20%20%20%20%26%20%5Cbeta%20%5Cin%20%5Cmathbb%7BR%7D%5Ep%2C%5C%3B%5C%3B%20z%20%5Cin%20%5C%7B0%2C1%5C%7D%5Ep%2C%5C%3B%5C%3B%20u%20%5Cin%20%5Cmathbb%7BR%7D_%2B%5Ep.%0A%20%20%20%20%5Cend%7Baligned%7D%0A%20%20%20%20%24%24%0A%20%20%20%20%22%22%22)%0A%20%20%20%20return%0A%0A%0A%40app.cell(hide_code%3DTrue)%0Adef%20_(mo)%3A%0A%20%20%20%20mo.md(r%22%22%22%0A%20%20%20%20%23%23%20Model%20Implementation%0A%20%20%20%20%22%22%22)%0A%20%20%20%20return%0A%0A%0A%40app.cell(hide_code%3DTrue)%0Adef%20_(mo)%3A%0A%20%20%20%20mo.md(r%22%22%22%0A%20%20%20%20The%20objective%20we%20are%20minimizing%20has%20three%20types%20of%20terms%3A%0A%0A%20%20%20%20%5C%5B%0A%20%20%20%20-2y%5E%5Ctop%20X%20%5Cbeta%20%5C%3B%2B%5C%3B%20%5Cbeta%5E%5Ctop%20(X%5E%5Ctop%20X%20%2B%20%5Clambda%20I)%5Cbeta%20%5C%3B%2B%5C%3B%20%5Cmu%20%5Csum_i%20u_i%20%5C%3B%2B%5C%3B%20%5Ctext%7Bconst.%7D%0A%20%20%20%20%5C%5D%0A%0A%20%20%20%20---%0A%0A%20%20%20%20%23%23%201.%20Linear%20terms%3A%0A%0A%20%20%20%20-%20The%20scalar%20term%20%5C(-2y%5E%5Ctop%20X%5Cbeta%5C)%20is%20a%20simple%20inner%20product%2C%20i.e.%20linear%20in%20the%20decision%20variables%20%5C(%5Cbeta%5C).%0A%20%20%20%20-%20The%20penalty%20%5C(%5Cmu%20%5Csum_i%20u_i%5C)%20is%20also%20linear%20in%20the%20auxiliary%20variables%20%5C(u_i%5C).%0A%20%20%20%20These%20can%20be%20added%20directly%20to%20the%20optimization%20model%20without%20special%20reformulation.%0A%0A%20%20%20%20---%0A%0A%20%20%20%20%23%23%202.%20Quadratic%20Term%0A%0A%20%20%20%20The%20expression%0A%0A%20%20%20%20%5C%5B%0A%20%20%20%20%5Cbeta%5E%5Ctop%20(X%5E%5Ctop%20X%20%2B%20%5Clambda%20I)%5Cbeta%0A%20%20%20%20%5C%5D%0A%0A%20%20%20%20is%20**quadratic**.%0A%20%20%20%20There%20are%20**two%20approaches**%20we%20can%20apply%20to%20handle%20it%20as%20a%20rotated%20second-order%20cone%20(RSOC)%20constraint.%0A%0A%0A%20%20%20%20---%0A%0A%20%20%20%20%23%23%23%20Option%201%3A%20Cholesky-based%20approach%0A%0A%20%20%20%20To%20encode%20it%20in%20a%20conic%20optimization%20model%2C%20we%20introduce%20an%20auxiliary%20variable%20%5C(t%5C)%20representing%20the%20quadratic%20form%3A%0A%0A%20%20%20%20%5C%5B%0A%20%20%20%20t%20%5C%3B%5Cge%5C%3B%20%5Cbeta%5E%5Ctop%20Q%20%5Cbeta%2C%20%5Cquad%20Q%20%3D%20X%5E%5Ctop%20X%20%2B%20%5Clambda%20I%0A%20%20%20%20%5C%5D%0A%0A%0A%0A%20%20%20%201.%20Since%20%5C(Q%5C)%20is%20positive%20semidefinite%20we%20can%20perform%20a%20**Cholesky%20decomposition**%3A%0A%0A%20%20%20%20%5C%5B%0A%20%20%20%20Q%20%3D%20L%20L%5E%5Ctop%0A%20%20%20%20%5C%5D%0A%0A%20%20%20%202.%20Express%20the%20quadratic%20form%20as%20a%20norm%3A%0A%0A%20%20%20%20%5C%5B%0A%20%20%20%20%5Cbeta%5E%5Ctop%20Q%20%5Cbeta%20%3D%20%5C%7C%20L%5E%5Ctop%20%5Cbeta%20%5C%7C_2%5E2%0A%20%20%20%20%5C%5D%0A%0A%20%20%20%203.%20Encode%20it%20as%20a%20**rotated%20SOC%20constraint**%3A%0A%0A%20%20%20%20%5C%5B%0A%20%20%20%20(1%2C%5C%3B%200.5%5C%2Ct%2C%5C%3B%20L%5E%5Ctop%20%5Cbeta)%20%5C%3B%5Cin%5C%3B%20%5Cmathcal%7BQ%7D_r%0A%20%20%20%20%5C%5D%0A%0A%20%20%20%20This%20enforces%20%5C(t%20%5Cge%20%5C%7C%20L%5E%5Ctop%20%5Cbeta%20%5C%7C_2%5E2%5C).%0A%0A%20%20%20%20---%0A%0A%20%20%20%20%23%23%23%20Option%202%3A%20Stacked-matrix%20approach%20(no%20Cholesky)%0A%0A%20%20%20%20Firstly%2C%20let's%20introduce%20an%20auxiliary%20variable%20%5C(t%5C)%20representing%20the%20quadratic%20form%20again%3A%0A%0A%20%20%20%20%5C%5B%0A%20%20%20%20t%20%5C%3B%5Cge%5C%3B%20%5Cbeta%5E%5Ctop%20(X%5E%5Ctop%20X%20%2B%20%5Clambda%20I)%5Cbeta%0A%20%20%20%20%5C%5D%0A%0A%20%20%20%201.%20Stack%20%5C(X%5C)%20and%20%5C(%5Csqrt%7B%5Clambda%7D%20I%5C)%20vertically%3A%0A%0A%20%20%20%20%5C%5B%0A%20%20%20%20%5Cbegin%7Bbmatrix%7D%20X%20%5C%5C%20%5Csqrt%7B%5Clambda%7D%20I%20%5Cend%7Bbmatrix%7D%0A%20%20%20%20%5C%5D%0A%0A%20%20%20%202.%20Express%20the%20quadratic%20form%20as%20a%20norm%3A%0A%0A%20%20%20%20%5C%5B%0A%20%20%20%20%5Cbeta%5E%5Ctop%20(X%5E%5Ctop%20X%20%2B%20%5Clambda%20I)%20%5Cbeta%20%3D%20%5Cleft%5C%7C%20%5Cbegin%7Bbmatrix%7D%20X%20%5C%5C%20%5Csqrt%7B%5Clambda%7D%20I%20%5Cend%7Bbmatrix%7D%20%5Cbeta%20%5Cright%5C%7C_2%5E2%0A%20%20%20%20%5C%5D%0A%0A%20%20%20%203.%20Introduce%20a%20scalar%20variable%20%5C(t%20%5Cge%20%5C%7C%20%5BX%3B%20%5Csqrt%7B%5Clambda%7D%20I%5D%20%5Cbeta%20%5C%7C_2%5C)%20and%20write%20as%20a%20**rotated%20SOC%20constraint**%3A%0A%0A%20%20%20%20%5C%5B%0A%20%20%20%20%5Cleft(1%2C%20%5Cfrac%7Bt%7D%7B2%7D%2C%20%5Cbegin%7Bbmatrix%7D%20X%20%5C%5C%20%5Csqrt%7B%5Clambda%7D%20I%20%5Cend%7Bbmatrix%7D%20%5Cbeta%20%5Cright)%20%5C%3B%5Cin%5C%3B%20%5Cmathcal%7BQ%7D_r%0A%20%20%20%20%5C%5D%0A%0A%20%20%20%20This%20approach%20avoids%20Cholesky%20factorization%20and%20works%20well%20when%20%5C(X%5C)%20is%20sparse.%0A%0A%20%20%20%20---%0A%0A%20%20%20%20**Note%20on%20selection%3A**%0A%0A%20%20%20%20-%20If%20%5C(X%5C)%20is%20**dense**%2C%20the%20Cholesky-based%20approach%20is%20usually%20faster%20and%20more%20efficient.%0A%20%20%20%20-%20If%20%5C(X%5C)%20is%20**sparse**%2C%20the%20stacked-matrix%20approach%20is%20preferred.%0A%0A%20%20%20%20The%20choice%20depends%20on%20the%20**structure%20of%20%5C(X%5C)**%20and%20the%20**solver%2Fdata%20requirements**.%0A%0A%0A%20%20%20%20%23%23%203.%20Putting%20it%20together%3A%0A%0A%20%20%20%20-%20The%20final%20objective%20is%20linear%20in%20%5C(%5Cbeta%2C%20u%2C%20t%5C).%0A%20%20%20%20-%20The%20only%20nonlinear%20part%20%5C(%5Cbeta%5E%5Ctop%20Q%20%5Cbeta%5C)%20has%20been%20reformulated%20into%20a%20**cone%20constraint**%2C%20so%20the%20solver%20can%20handle%20it%20efficiently.%0A%20%20%20%20%22%22%22)%0A%20%20%20%20return%0A%0A%0A%40app.cell(hide_code%3DTrue)%0Adef%20_(mo)%3A%0A%20%20%20%20mo.md(r%22%22%22%0A%20%20%20%20%23%20Implementing%20the%20model%20in%20Python%0A%20%20%20%20%22%22%22)%0A%20%20%20%20return%0A%0A%0A%40app.cell(hide_code%3DTrue)%0Adef%20_(mo)%3A%0A%20%20%20%20mo.md(r%22%22%22%0A%20%20%20%20The%20following%20function%20implements%20the%20model%20described%20earlier.%0A%0A%20%20%20%20The%20quadratic%20term%20can%20be%20handled%20using%20**either%20of%20the%20two%20approaches**%20depending%20on%20the%20user%E2%80%99s%20preference%20and%20the%20input%20data%3A%0A%0A%20%20%20%20-%20If%20the%20user%20sets%20%60cholesky%20%3D%20True%60%20(the%20**default**)%2C%20the%20function%20uses%20the%20**Cholesky-based%20transformation**%20(Option%201).%0A%20%20%20%20-%20If%20the%20user%20sets%20%60cholesky%20%3D%20False%60%2C%20the%20function%20uses%20the%20**stacked-matrix%20transformation**%20(Option%202).%0A%0A%20%20%20%20This%20design%20allows%20the%20model%20to%20adapt%20to%20the%20structure%20of%20the%20input%20data%20and%20the%20user%E2%80%99s%20requirements%20while%20keeping%20the%20implementation%20flexible.%0A%20%20%20%20%22%22%22)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(Domain%2C%20Expr%2C%20Model%2C%20ObjectiveSense%2C%20np%2C%20time)%3A%0A%20%20%20%20def%20RankOne(n%2C%20p%2C%20lmb%2C%20mu%2C%20y%20%2C%20X%2C%20k%2Ccholesky%20%3D%20True)%3A%0A%20%20%20%20%20%20%20%20M%20%3D%20Model(%22RankOne%22)%0A%0A%20%20%20%20%20%20%20%20%23%20Decision%20variables%0A%20%20%20%20%20%20%20%20B%20%3D%20M.variable(%22B%22%2C%20p%2C%20Domain.unbounded())%20%20%20%20%20%20%20%20%23%20regression%20coefficients%20%CE%B2%0A%20%20%20%20%20%20%20%20u%20%3D%20M.variable(%22u%22%2C%20p%2C%20Domain.greaterThan(0.0))%20%20%20%23%20auxiliary%20vars%20for%20%7C%CE%B2%7C%0A%20%20%20%20%20%20%20%20t%20%3D%20M.variable(%22t%22%2C%201)%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%23%20scalar%20var%20for%20quadratic%20form%0A%20%20%20%20%20%20%20%20z%20%3D%20M.variable(%22z%22%2C%20p%2C%20Domain.binary())%20%20%20%20%20%20%20%20%20%20%20%23%20binary%20indicators%20for%20support%0A%0A%20%20%20%20%20%20%20%20%23%20Objective%20part%3A%20y%E1%B5%80y%20(constant%2C%20included%20for%20completeness)%0A%20%20%20%20%20%20%20%20term1%20%3D%20y.T%20%40%20y%0A%0A%20%20%20%20%20%20%20%20%23%20Objective%20part%3A%20-2%20y%E1%B5%80X%CE%B2%0A%20%20%20%20%20%20%20%20term2%20%3D%20-2%20*%20Expr.mul(y.reshape(1%2C%20-1)%2C%20Expr.mul(X%2C%20B))%0A%0A%20%20%20%20%20%20%20%20if%20cholesky%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%23%20Quadratic%20term%20%CE%B2%E1%B5%80(X%E1%B5%80X%20%2B%20%CE%BBI)%CE%B2%20handled%20with%20rotated%20quadratic%20cone%0A%20%20%20%20%20%20%20%20%20%20%20%20Q%20%3D%20(X.T%20%40%20X%20%2B%20lmb%20*%20np.identity(p))%0A%20%20%20%20%20%20%20%20%20%20%20%20w%2C%20V%20%3D%20np.linalg.eigh(Q)%20%20%20%20%20%20%20%20%23%20eigen-decomposition%0A%20%20%20%20%20%20%20%20%20%20%20%20L%20%3D%20V%20%40%20np.diag(np.sqrt(w))%20%20%20%20%20%23%20factor%20such%20that%20Q%20%3D%20L%20L%E1%B5%80%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%23%20Cone%20constraint%3A%20(1%2C%200.5t%2C%20L%E1%B5%80B)%20%E2%88%88%20Rotated%20Quadratic%20Cone%0A%20%20%20%20%20%20%20%20%20%20%20%20M.constraint(%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20Expr.vstack(1.0%2C%200.5%20*%20t%2C%20Expr.mul(L.T%2C%20B))%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20Domain.inRotatedQCone()%0A%20%20%20%20%20%20%20%20%20%20%20%20)%0A%20%20%20%20%20%20%20%20else%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%23%20This%20corresponds%20to%20the%20stacked%20matrix%20%5BX%3B%20sqrt(lambda)%20*%20I_p%5D%20used%20for%20the%20quadratic%20form%0A%20%20%20%20%20%20%20%20%20%20%20%20Xp%20%3D%20np.vstack(%5BX%2C%20np.sqrt(lmb)%20*%20np.identity(p)%5D)%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%23%20Rotated%20Quadratic%20Cone%20constraint%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%23%20(1%2C%200.5*t%2C%20%5BX%3B%20sqrt(lambda)%20I_p%5D%20*%20%CE%B2)%20%E2%88%88%20Rotated%20Quadratic%20Cone%0A%20%20%20%20%20%20%20%20%20%20%20%20%23%20This%20encodes%20the%20quadratic%20term%20%CE%B2%E1%B5%80(X%E1%B5%80X%20%2B%20%CE%BBI)%CE%B2%20as%20a%20rotated%20cone%20constraint%0A%20%20%20%20%20%20%20%20%20%20%20%20M.constraint(%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20Expr.vstack(1.0%2C%200.5%20*%20t%2C%20Expr.mul(Xp%2C%20B))%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20Domain.inRotatedQCone()%0A%20%20%20%20%20%20%20%20%20%20%20%20)%0A%0A%0A%20%20%20%20%20%20%20%20%23%20L1%20penalty%20term%20%CE%BC%E2%88%91%20u_i%0A%20%20%20%20%20%20%20%20term4%20%3D%20mu%20*%20Expr.sum(u)%0A%0A%20%20%20%20%20%20%20%20%23%20Cardinality%20constraint%3A%20at%20most%20k%20nonzeros%0A%20%20%20%20%20%20%20%20M.constraint(Expr.sum(z)%20%3C%3D%20k)%0A%0A%20%20%20%20%20%20%20%20%23%20Relating%20u%20and%20B%3A%20%7C%CE%B2_i%7C%20%E2%89%A4%20u_i%0A%20%20%20%20%20%20%20%20M.constraint(B%20%3C%3D%20u)%0A%20%20%20%20%20%20%20%20M.constraint(-B%20%3C%3D%20u)%0A%0A%20%20%20%20%20%20%20%20%23%20Either-or%20condition%3A%20z_i%20%3D%201%20OR%20%CE%B2_i%20%3D%200%0A%20%20%20%20%20%20%20%20M.disjunction((z%20%3D%3D%201)%20%7C%20(B%20%3D%3D%200))%0A%0A%20%20%20%20%20%20%20%20%23%20Final%20objective%3A%20min%20(y%E1%B5%80y%20-%202%20y%E1%B5%80X%CE%B2%20%2B%20%CE%B2%E1%B5%80Q%CE%B2%20%2B%20%CE%BC%E2%80%96%CE%B2%E2%80%96%E2%82%81)%0A%20%20%20%20%20%20%20%20M.objective(ObjectiveSense.Minimize%2C%20term2%20%2B%20t%20%2B%20term4%20%2B%20term1)%0A%0A%20%20%20%20%20%20%20%20%23%20Export%20model%20and%20solve%0A%20%20%20%20%20%20%20%20M.writeTask(%22RankOne.ptf%22)%0A%20%20%20%20%20%20%20%20s%20%3D%20time.time()%0A%20%20%20%20%20%20%20%20M.solve()%0A%20%20%20%20%20%20%20%20elapsed%20%3D%20time.time()%20-%20s%0A%20%20%20%20%20%20%20%20print(f%22Elapsed%20Time%3A%20%7Belapsed%3A.4f%7D%20s%22)%0A%20%20%20%20%20%20%20%20print(f%22Objective%20value%3A%20%7BM.primalObjValue()%3A.4f%7D%22)%0A%20%20%20%20%20%20%20%20%23%20Print%20solution%20status%0A%20%20%20%20%20%20%20%20ModelStatus%20%3D%20M.getPrimalSolutionStatus()%0A%20%20%20%20%20%20%20%20print(%22Model%20Status%3A%20%22%2C%20ModelStatus)%0A%0A%20%20%20%20%20%20%20%20return%20M%0A%20%20%20%20return%20(RankOne%2C)%0A%0A%0A%40app.cell(hide_code%3DTrue)%0Adef%20_(mo)%3A%0A%20%20%20%20mo.md(r%22%22%22%0A%20%20%20%20The%20described%20model%20is%20implemented%20using%20Mosek%20above.%0A%0A%20%20%20%20%60%60%60python%0A%20%20%20%20%20%20%20%20M.disjunction((z%20%3D%3D%201)%20%7C%20(B%20%3D%3D%200))%0A%20%20%20%20%60%60%60%0A%0A%20%20%20%20The%20line%20above%20illustrates%20how%20**Mosek%20can%20implement%20disjunction%20constraints**%20without%20requiring%20any%20additional%20transformations%2C%20such%20as%20using%20Big-M%20values.%0A%0A%20%20%20%20To%20run%20the%20model%2C%20we%20use%20the%20*diabetes%20dataset*%20shared%20by%20the%20referenced%20paper.%20We%20download%2C%20and%20load%20the%20dataset%20online%20in%20the%20code%20block%20below.%0A%20%20%20%20%22%22%22)%0A%20%20%20%20return%0A%0A%0A%40app.cell(hide_code%3DTrue)%0Adef%20_(mo)%3A%0A%20%20%20%20mo.md(r%22%22%22%0A%20%20%20%20%23%23%20Loading%20the%20Data%0A%20%20%20%20%22%22%22)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(StandardScaler%2C%20glob%2C%20io%2C%20os%2C%20pd%2C%20requests%2C%20zipfile)%3A%0A%20%20%20%20%23%20URL%20of%20the%20data%0A%20%20%20%20url%20%3D%20%22https%3A%2F%2Fatamturk.ieor.berkeley.edu%2Fdata%2Fsparse.regression%2Fdata.sparse.regression.zip%22%0A%0A%20%20%20%20%23%20Download%20and%20unzip%0A%20%20%20%20r%20%3D%20requests.get(url)%0A%20%20%20%20z%20%3D%20zipfile.ZipFile(io.BytesIO(r.content))%0A%20%20%20%20extract_dir%20%3D%20%22data_sparse_regression%22%0A%20%20%20%20z.extractall(extract_dir)%20%20%23%20extracts%20to%20a%20local%20folder%0A%0A%20%20%20%20%23%20Find%20a%20file%20that%20looks%20like%20the%20diabetes%20dataset%20(e.g.%2C%20diabetes*.csv%20%2F%20.txt)%0A%20%20%20%20candidates%20%3D%20glob.glob(os.path.join(extract_dir%2C%20%22**%22%2C%20%22diabetes*.*%22)%2C%20recursive%3DTrue)%0A%20%20%20%20if%20not%20candidates%3A%0A%20%20%20%20%20%20%20%20%23%20If%20you%20know%20the%20exact%20name%2C%20set%20it%20here%3A%0A%20%20%20%20%20%20%20%20%23%20file_path%20%3D%20os.path.join(extract_dir%2C%20%22data.sparse.regression%22%2C%20%22diabetesQ.csv%22)%0A%20%20%20%20%20%20%20%20raise%20FileNotFoundError(%22No%20file%20matching%20'diabetes*'%20was%20found%20in%20the%20extracted%20contents.%22)%0A%0A%20%20%20%20file_path%20%3D%20candidates%5B0%5D%0A%20%20%20%20print(%22Using%20file%3A%22%2C%20file_path)%0A%0A%20%20%20%20%23%20Read%20the%20dataset%20(let%20pandas%20sniff%20the%20delimiter%20if%20not%20comma)%0A%20%20%20%20df%20%3D%20pd.read_csv(file_path%2C%20sep%3DNone%2C%20engine%3D%22python%22)%0A%20%20%20%20print(%22Columns%20in%20dataset%3A%22%2C%20df.columns.tolist())%0A%0A%20%20%20%20%23%20Assuming%20the%20last%20column%20is%20the%20target%20variable%0A%20%20%20%20X_nonSTD%20%3D%20df.iloc%5B%3A%2C%20%3A-1%5D.values%0A%20%20%20%20y%20%3D%20df.iloc%5B%3A%2C%20-1%5D.values%0A%0A%20%20%20%20X_nonSTD%20%3D%20X_nonSTD.astype(float)%0A%0A%20%20%20%20%23%20Standardize%20features%3A%20zero%20mean%2C%20unit%20variance%0A%20%20%20%20x_scaler%20%3D%20StandardScaler()%0A%20%20%20%20X%20%3D%20x_scaler.fit_transform(X_nonSTD)%0A%0A%20%20%20%20print(%22Shape%20of%20X%20(features)%3A%22%2C%20X.shape)%0A%20%20%20%20print(%22Shape%20of%20y%20(target)%3A%22%2C%20y.shape)%0A%20%20%20%20return%20X%2C%20y%0A%0A%0A%40app.cell(hide_code%3DTrue)%0Adef%20_(mo)%3A%0A%20%20%20%20mo.md(r%22%22%22%0A%20%20%20%20Then%20using%20the%20loaded%20data%2C%20we%20can%20run%20the%20problem.%20As%20it%20can%20be%20seen%20from%20the%20printed%20out%20message%20below%2C%20the%20model%20is%20solved%20to%20feasibility.%0A%20%20%20%20%22%22%22)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(RankOne%2C%20X%2C%20y)%3A%0A%20%20%20%20n%2Cp%20%3D%20X.shape%5B0%5D%2CX.shape%5B1%5D%0A%20%20%20%20lmb%20%3D%205%0A%20%20%20%20mu%20%3D%201%0A%20%20%20%20k%20%3D%20p*0.8%0A%0A%20%20%20%20RankOne(n%2C%20p%2C%20lmb%2C%20mu%2C%20y%20%2C%20X%2C%20k%2CTrue)%0A%20%20%20%20return%0A%0A%0Aif%20__name__%20%3D%3D%20%22__main__%22%3A%0A%20%20%20%20app.run()%0A
</marimo-code>

<marimo-code-hash hidden="">16a4195517e5cfb8930006fb8e42260b</marimo-code-hash>
</body>
</html>
